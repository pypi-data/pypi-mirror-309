"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[496],{9965:function(e,t,a){a.d(t,{h:function(){return L}});var s=a(57437),l=a(2265),r=a(99376),n=a(40875),o=a(38691),i=a(42396),d=a(33544),c=a(61994),u=a(51268),m=a(83986);let b=e=>(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsxs)("div",{className:"text-gray-500",children:[(0,s.jsx)(u.G,{icon:m.cC_,className:"h-[12px] mr-1"}),(0,s.jsx)("span",{children:e.label})]}),(0,s.jsx)("div",{className:"ml-auto",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.options.length})})]}),h=e=>{let{value:t,label:a,description:l}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:a}),(0,s.jsx)("div",{className:"text-gray-500",children:l})]})},g={control:{base:"flex border rounded-md bg-input hover:cursor-pointer min-w-[100px] !min-h-[36px] w-[100%] h-[100%] text-foreground text-foreground",focus:"",nonFocus:"border-border"},option:{base:"hover:cursor-pointer px-3 py-2 rounded flex gap-2 items-center hover:bg-muted !text-sm",focus:"bg-[rgba(var(--primary),0.1)]",selected:"bg-[rgba(var(--primary),0.3)] hover:bg-[rgba(var(--primary),0.3)] text-primary font-bold"}},p={control:e=>{let{isFocused:t}=e;return(0,c.W)(t?g.control.focus:g.control.nonFocus,g.control.base)},option:e=>{let{isSelected:t,isFocused:a}=e;return(0,c.W)(g.option.base,t?g.option.selected:"",a?g.option.focus:"")},menu:()=>"p-1 mt-1 bg-white rounded-md shadow-md",placeholder:()=>"text-placeholder pl-1",input:()=>"text-foreground pl-1",valueContainer:()=>"p-1 gap-1",singleValue:()=>"pl-1",multiValue:()=>"flex bg-[rgba(var(--primary),0.15)] p-0 pl-2 rounded-sm text-xs overflow-hidden",multiValueLabel:()=>"py-1",multiValueRemove:()=>"bg-[rgba(var(--primary),0.1)] hover:bg-[rgba(var(--primary),0.2)] text-primary px-1 ml-2",indicatorsContainer:()=>"p-1 gap-1",clearIndicator:()=>"text-muted-foreground px-1 hover:text-error",indicatorSeparator:()=>"bg-border",dropdownIndicator:()=>"p-1 hover:bg-muted text-muted-foreground rounded-md hover:text-foreground",groupHeading:()=>"ml-3 mt-2 mb-1 text-muted-foreground text-sm",noOptionsMessage:()=>"text-placeholder py-3"},x=e=>{let{options:t,className:a,isClearable:r=!1,isMulti:n=!1,value:o,onChange:u,useFormatOptionLabel:m=!1}=e;return(0,s.jsx)(i.ZP,{instanceId:(0,l.useId)(),unstyled:!0,options:t,isMulti:n,value:o,isClearable:r,onChange:u,classNames:{...p},className:(0,c.W)(a),formatGroupLabel:b,formatOptionLabel:m?h:void 0,components:{Input:e=>(0,s.jsx)(d.c.Input,{...e,"aria-activedescendant":void 0})}})},f=e=>{let{handleFetchData:t}=e,[a,n]=(0,l.useState)([]),[i,d]=(0,l.useState)(""),c=(0,o.o)(e=>e.setLoading),u=(0,o.o)(e=>e.setColumnModeEdges),m=(0,o.o)(e=>e.setIsSubmitDisabled),b=(0,o.o)(e=>e.setHeaderSearchDisplayMessage),h=(0,o.o)(e=>e.submitClicked),g=(0,o.o)(e=>e.resetSubmitClicked),p=(0,r.usePathname)(),f=(0,r.useRouter)(),v=(0,r.useSearchParams)(),w=a.reduce((e,t)=>{let a=t.description.split("/").slice(0,-1).join("/"),s=e.find(e=>e.label===a),l={value:t.value,label:t.label,description:""};return s?s.options.push(l):e.push({label:a,options:[l]}),e},[]),j=(0,l.useCallback)(async()=>{let e=await fetch("".concat("","/api/v1/dashboards")),t=await e.json();"success"===t.status&&n(t.data.sort((e,t)=>e.folder_path.localeCompare(t.folder_path)).map(e=>({value:e.id,label:e.title,description:e.folder_path})))},[!0]),y=(0,l.useCallback)(async e=>{d(e)},[]),C=(0,l.useCallback)(async function(){let e,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(a){let t=v.get("dashboardId");j(),d(t),e={dashboardId:t}}else e={dashboardId:i};c(!0);let s=await t(e);if(c(!1),u([]),!a&&s){let e=new URLSearchParams({dashboardId:i});f.push("".concat(p,"?").concat(e))}},[i]);return(0,l.useEffect)(()=>{v.size?C(!0):j()},[]),(0,l.useEffect)(()=>{m(!i)},[i]),(0,l.useEffect)(()=>{if(i){var e;b((null==a?void 0:null===(e=a.find(e=>e.value===i))||void 0===e?void 0:e.label)||"Select dashboard")}else b("Select dashboard")},[i,a]),(0,l.useEffect)(()=>{h&&(console.log(h),C(),g())},[h]),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Dashboard"}),(0,s.jsx)(x,{options:w,value:a.find(e=>e.value===i),onChange:e=>y(e.value),isClearable:!0,useFormatOptionLabel:!0})]})};var v=a(82029),w=a(33003);let j=e=>{let{handleFetchData:t}=e,[a,n]=(0,l.useState)([]),[i,d]=(0,l.useState)([]),[u,m]=(0,l.useState)({}),[b,h]=(0,l.useState)(""),[g,p]=(0,l.useState)([]),[f,j]=(0,l.useState)(""),[y,C]=(0,l.useState)([]),[N,S]=(0,l.useState)({}),[k,E]=(0,l.useState)(!0),M=(0,o.o)(e=>e.setLoading),D=(0,o.o)(e=>e.setColumnModeEdges),L=(0,o.o)(e=>e.setIsSubmitDisabled),P=(0,o.o)(e=>e.setHeaderSearchDisplayMessage),I=(0,o.o)(e=>e.submitClicked),z=(0,o.o)(e=>e.resetSubmitClicked),F=(0,r.usePathname)(),R=(0,r.useRouter)(),Z=(0,r.useSearchParams)(),O="/cl"===F,_=[{id:"table",icon:v.Z,label:"Table"},{id:"column",icon:w.Z,label:"Column"}],A=(0,l.useCallback)(async()=>{let e=await fetch("".concat("","/api/v1/schemas")),t=await e.json();return n(t),t},[]),U=(0,l.useCallback)(async e=>{let t=new URLSearchParams({schema:e}),a=await fetch("".concat("","/api/v1/sources?").concat(t)),s=await a.json();return d(s),s},[]),H=(0,l.useCallback)(async e=>{let t=new URLSearchParams({source:e}),a=await fetch("".concat("","/api/v1/columns?").concat(t)),s=await a.json();return m(t=>({...t,[e]:s})),s},[]),T=(0,l.useCallback)(async e=>{h(e),await U(e)},[U]),V=(0,l.useCallback)(async e=>{p(e)},[]),W=(0,l.useCallback)(e=>{C(e),S(t=>({...t,[f]:e}))},[f]),G=(0,l.useCallback)(async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];j(e),u[e]||await H(e),t&&C(N[e]||[])},[u,N,H]),J=(0,l.useCallback)(async function(){let e,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(a){var s;let t=Z.get("schema"),a=(null===(s=Z.get("sources"))||void 0===s?void 0:s.split(","))||[],l=Z.get("activeSource"),r=JSON.parse(Z.get("selectedColumns"))||{},n=Z.get("showColumn"),o="true"==n,i=parseInt(Z.get("depth"));A(),T(t),V(a),G(l,!1),n&&E(o),S(r),C(r[l]||[]),e={schema:t,sources:a,columns:r,showColumn:o,depth:i}}else e={schema:b,sources:g,columns:N,showColumn:k,depth:NaN};M(!0);let l=await t(e);if(M(!1),D([]),!a&&l){let e=new URLSearchParams({schema:b,sources:g.join(","),activeSource:f,selectedColumns:JSON.stringify(N),showColumn:k.toString()});R.push("".concat(F,"?").concat(e))}},[F,b,g,f,k,N]),B=(0,l.useCallback)(e=>{E(e)},[E]);return(0,l.useEffect)(()=>{Z.size?J(!0):(A(),U(b),H(f))},[]),(0,l.useEffect)(()=>{if(!(b&&g.length>0)){L(!0);return}if(O&&k){L(!g.some(e=>{var t;return(null===(t=N[e])||void 0===t?void 0:t.length)>0}));return}L(!1)},[b,g,f,N,k]),(0,l.useEffect)(()=>{b||f||y.length>0?P([b,f,y.length>0?y.join(", "):null].filter(Boolean).join(" | ")):P("Select search model")},[b,f,y]),(0,l.useEffect)(()=>{I&&(console.log(I),J(),z())},[I]),(0,s.jsxs)("div",{children:[O&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"View Mode"}),(0,s.jsx)("div",{className:"inline-flex rounded-md shadow-sm mb-4",role:"group",children:_.map(e=>(0,s.jsxs)("button",{type:"button",className:"px-4 py-2 text-sm font-medium border flex items-center whitespace-nowrap ".concat((k?"column":"table")===e.id?"bg-blue-500 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"," ").concat("table"===e.id?"rounded-l-lg":"rounded-r-lg"),onClick:()=>B("column"===e.id),children:[(0,s.jsx)(e.icon,{className:"mr-2",size:16}),(0,s.jsx)("span",{children:e.label})]},e.id))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Schema"}),(0,s.jsx)(x,{options:a,value:{label:b,value:b},onChange:e=>T(e.value),className:"mb-4"}),(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Sources"}),(0,s.jsx)(x,{options:i,value:g.map(e=>({label:e,value:e})),onChange:(e,t)=>{if(O){let a=e.map(e=>e.value);V(a),"select-option"===t.action?G(t.option.value):G(a[0])}else V([e.value]),G(e.value)},className:"mb-2",isMulti:O,useFormatOptionLabel:!0})]}),k&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Active Source"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:g.map(e=>(0,s.jsx)("button",{className:(0,c.W)("px-3 py-1 rounded-md text-sm font-medium",e===f?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),onClick:()=>G(e),children:e},e))}),(0,s.jsx)("div",{className:"font-medium text-gray-700 mb-2",children:"Columns"}),u[f]&&(0,s.jsx)(x,{options:u[f],value:y.map(e=>({label:e,value:e})),onChange:(e,t)=>{if("clear"===t.action){W([]);return}O?W(e.map(e=>e.value)):W([e.value])},className:"mb-2",isMulti:O,isClearable:!O,useFormatOptionLabel:!0})]})]})]})},y=e=>{let{handleFetchData:t}=e,[a,i]=(0,l.useState)(!1),d=(0,l.useRef)(null),c=(0,o.o)(e=>e.headerSearchDisplayMessage),u=(0,o.o)(e=>e.sourceMode),m=(0,o.o)(e=>e.setSourceMode),b=(0,r.useSearchParams)(),h="/cl"===(0,r.usePathname)(),g=e=>{window.history.replaceState({},"",window.location.pathname),m(e)};return(0,l.useEffect)(()=>{b.get("dashboardId")&&m("looker")},[]),(0,l.useEffect)(()=>{h||m("dbt")},[h]),(0,l.useEffect)(()=>{function e(e){["svg","path"].includes(e.target.tagName.toLowerCase())||!d.current||d.current.contains(e.target)||i(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[d]),(0,s.jsxs)("div",{ref:d,className:"relative inline-block text-left mr-2 w-[60vw]",children:[(0,s.jsxs)("button",{type:"button",className:"inline-flex justify-between rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-indigo-500 mr-2 w-full",onClick:()=>i(!a),children:[(0,s.jsx)("span",{className:"text-gray-700",children:c}),(0,s.jsx)(n.Z,{className:"ml-2 -mr-1 h-5 w-5","aria-hidden":"true"})]}),(0,s.jsxs)("div",{className:"origin-top-left absolute left-0 mt-2 w-[900px] rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50 ".concat(a?"block":"hidden"),children:[h&&(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsx)("nav",{className:"px-2 pt-2",children:(0,s.jsx)("ul",{className:"flex space-x-1 text-xs",children:[{id:"dbt",label:"dbt"},{id:"looker",label:"looker"}].map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("button",{onClick:()=>g(e.id),className:"px-3 py-1.5 rounded-t transition-colors duration-150 relative ".concat(u===e.id?"bg-blue-500 text-white shadow-sm font-medium":"text-gray-600 hover:bg-gray-100"),children:e.label})},e.id))})})}),(0,s.jsx)("div",{className:"p-4",children:"dbt"===u?(0,s.jsx)(j,{handleFetchData:t}):(0,s.jsx)(f,{handleFetchData:t})})]})]})};var C=a(30401),N=a(76865),S=a(33245),k=a(15001),E=a(73247),M=a(65504),D=a(91305);let L=e=>{let{handleFetchData:t}=e,[a,n]=(0,l.useState)("/cl"),i=(0,r.usePathname)(),d=(0,r.useRouter)(),c=(0,o.o)(e=>e.triggerSubmitClicked),u=(0,o.o)(e=>e.loading),m=(0,o.o)(e=>e.message),b=(0,o.o)(e=>e.messageType),h=(0,o.o)(e=>e.isSubmitDisabled);return(0,l.useEffect)(()=>{i!==a&&n(i)},[]),(0,s.jsxs)("div",{children:[m&&(0,s.jsxs)("div",{className:"absolute top-4 right-4 px-4 py-3 rounded shadow-md z-50 flex items-center ".concat("success"===b?"bg-green-100 border-green-400 text-green-700":"error"===b?"bg-red-100 border-red-400 text-red-700":"bg-blue-100 border-blue-400 text-blue-700"),role:"alert",children:[(e=>{switch(e){case"success":return(0,s.jsx)(C.Z,{className:"inline-block mr-2",size:20});case"error":return(0,s.jsx)(N.Z,{className:"inline-block mr-2",size:20});default:return(0,s.jsx)(S.Z,{className:"inline-block mr-2",size:20})}})(b),(0,s.jsx)("div",{className:"sm:inline text-xs max-w-xl",children:(0,s.jsx)(M.U,{className:"markdown",remarkPlugins:[D.Z],children:m})})]}),(0,s.jsx)("header",{className:"bg-white border-b-[1px]",children:(0,s.jsxs)("nav",{className:"container mr-auto flex flex-wrap flex-col md:flex-row items-center",children:[(0,s.jsx)("a",{className:"flex title-font font-medium items-center text-gray-900 mb-4 md:mb-0",children:(0,s.jsx)("span",{className:"ml-3 text-xl",children:(0,s.jsxs)("select",{value:a,onChange:e=>d.push(e.target.value),children:[(0,s.jsx)("option",{value:"/cte",children:"CTE Lineage"}),(0,s.jsx)("option",{value:"/cl",children:"Column Level Lineage"})]})})}),(0,s.jsxs)("nav",{className:"md:mr-auto md:ml-4 md:py-2 md:pl-4 md:border-l md:border-gray-400 flex flex-wrap items-center text-base justify-center",children:[(0,s.jsx)(y,{handleFetchData:t}),(0,s.jsxs)("button",{type:"button",className:"rounded px-3 py-1.5 text-s font-medium border bg-blue-400 text-white border-blue-400 flex items-center hover:bg-blue-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",onClick:c,disabled:h,children:[u?(0,s.jsx)(k.Z,{className:"animate-spin mr-2",size:16}):(0,s.jsx)(E.Z,{className:"mr-2",size:16}),(0,s.jsx)("span",{children:u?"Loading...":"Search"})]})]})]})})]})}},96627:function(e,t,a){a.d(t,{Y:function(){return l}});var s=a(2265);let l=()=>{let[e,t]=(0,s.useState)({width:0,height:600});return(0,s.useEffect)(()=>{{let e=()=>{t({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}},[]),e}},93448:function(e,t,a){a.d(t,{C:function(){return s},p:function(){return l}});let s=e=>{switch(e){case"table":return"bg-[#E6E6FA]";case"view":return"bg-[#F0E6FF]";case"incremental":return"bg-[#ADD8E6]";case"snapshot":return"bg-indigo-200";case"seed":return"bg-violet-200";default:return"bg-gray-200"}},l=["table","view","incremental","snapshot","seed"]},38691:function(e,t,a){a.d(t,{o:function(){return s}});let s=(0,a(97094).Ue)()(e=>({options:{rankdir:"LR"},showColumn:!0,sidebarActive:!1,loading:!1,clearNodePosition:!1,columnModeEdges:[],leftMaxDepth:!1,rightMaxDepth:!1,message:null,messageType:null,sourceMode:"dbt",submitClicked:!1,isSubmitDisabled:!1,headerSearchDisplayMessage:"Select search model",setOptions:t=>e({options:t}),setShowColumn:t=>e({showColumn:t}),setSidebarActive:t=>e({sidebarActive:t}),setLoading:t=>e({loading:t}),setClearNodePosition:t=>e({clearNodePosition:t}),setColumnModeEdges:t=>e({columnModeEdges:t}),setLeftMaxDepth:t=>e({leftMaxDepth:t}),setRightMaxDepth:t=>e({rightMaxDepth:t}),setMessage:(t,a)=>e({message:t,messageType:a}),setSourceMode:t=>e({sourceMode:t}),triggerSubmitClicked:()=>e({submitClicked:!0}),resetSubmitClicked:()=>e({submitClicked:!1}),setIsSubmitDisabled:t=>e({isSubmitDisabled:t}),setHeaderSearchDisplayMessage:t=>e({headerSearchDisplayMessage:t})}))}}]);
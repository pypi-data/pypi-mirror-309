"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[7066],{97066:(e,s,t)=>{t.r(s),t.d(s,{ExerciseEdit:()=>C,default:()=>S});var i=t(4565),r=t(89456),n=t(17168),a=t(41237),o=t(36088),l=t(66578),c=t(83773),d=t(43429),h=t(52333),u=t(12784),x=t(25939),p=t(79146),j=t(47627),g=t(48968),m=t(20398),Z=t(34441),f=t(58114),b=t(58783),y=t(36057),k=t(80003),v=t(1890),w=t(4789);const C=()=>{const{accountHandle:e,spaceHandle:s,exerciseId:t}=(0,n.UO)();if(!t)return(0,i.jsx)(i.Fragment,{});const C=(0,k.aF)(),{kernelManager:S,defaultKernel:T}=(0,f.W$)(),E=(0,w.qX)(),D=((0,w.Ae)(),(0,b.gQ)()),P=E.layout().organization,$=E.layout().space,_=(0,r.useMemo)((()=>T),[S]),{cloneExercise:L,getExercise:R,getSpaceDatasets:z,refreshExercise:V,refreshSpaceDatasets:q,updateExercise:I}=(0,k.YT)(),[H,W]=(0,r.useState)(z()),A=D.outputs?.get("exercise-pre")?.input,F=D.outputs?.get("exercise-solution")?.input,Q=D.outputs?.get("exercise-question")?.input,N=D.outputs?.get("exercise-test")?.input,U=(0,a.N)(),[M,O]=(0,r.useState)(!1),B=(0,k.s0)(),{enqueueToast:G}=(0,k.pm)(),[K,X]=(0,r.useState)();(0,r.useEffect)((()=>{V(t).then((e=>{if(e.success){const e=R(t);e?(X(e),E.layout().setItem(e),J((s=>({...s,name:e.name,description:e.description,help:e.help})))):B("/")}}))}),[t]),(0,r.useEffect)((()=>{$&&q($,P).then((e=>{e.success&&W(z())}))}),[$]);const[Y,J]=(0,r.useState)({name:"",description:"",help:'Use the assignment operator "=" to create the variable "x".'}),[ee,se]=(0,r.useState)({name:!1,description:!1,help:!0});(0,r.useEffect)((()=>{se({...ee,name:Y.name.length>2,description:Y.description.length>2})}),[Y]);const te=(0,r.useCallback)((async e=>{U({title:"Are you sure?",content:"Please confirm you want to clone this exercise in your private library."}).then((e=>{e&&L(t).then((e=>{e.success&&(G(e.message,{variant:"success"}),E.layout().triggerItemsRefresh(),B(`/${C?.handle}/library/exercises`))}))}))}),[U,K]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z,{children:(0,i.jsxs)(l.Z,{display:"flex",children:[(0,i.jsx)(l.Z,{flex:1,children:(0,i.jsx)(c.Z,{sx:{fontSize:3},children:"Exercise editor"})}),(0,i.jsx)(l.Z,{children:(0,i.jsxs)(d.Z,{children:[(0,i.jsx)(h.r,{variant:"default",size:"small",onClick:()=>B(`/${e}/${s}/exercise/${K?.id}/take`),children:"Take this exercise"}),$&&(0,i.jsx)(h.r,{variant:"default",size:"small",leadingVisual:Z.jcu,onClick:te,children:"Clone"})]})})]})}),K&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.Z,{children:[(0,i.jsxs)(l.Z,{sx:{label:{marginTop:2}},children:[(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(u.Z.Label,{children:"Name"}),(0,i.jsx)(x.Z,{block:!0,value:Y.name,onChange:e=>{J((s=>({...s,name:e.target.value})))}}),!ee.name&&(0,i.jsx)(u.Z.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(u.Z.Label,{children:"Description"}),(0,i.jsx)(p.ZP,{block:!0,value:Y.description,onChange:e=>{J((s=>({...s,description:e.target.value})))}}),!ee.description&&(0,i.jsx)(u.Z.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,i.jsxs)(l.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:3,children:[(0,i.jsxs)(l.Z,{children:[(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(u.Z.Label,{children:"Preliminary code"}),(0,i.jsx)(u.Z.Caption,{children:"This is the preliminary code that will be run before the exercise is taken."})]}),(0,i.jsx)(y.r,{showEditor:!0,autoRun:!0,kernel:_,code:K.codePre,id:"exercise-pre"})]}),(0,i.jsxs)(l.Z,{children:[(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(u.Z.Label,{children:"Datasets"}),(0,i.jsx)(u.Z.Caption,{children:"Select the datasets to be used in the prelimary code."})]}),(0,i.jsx)(j.S,{showDividers:!0,role:"listbox","aria-label":"Select assignees",children:H.map((e=>(0,i.jsxs)(j.S.Item,{role:"option",onClick:s=>{s.preventDefault(),D.setDataset("exercise-pre",e)},children:[(0,i.jsx)(j.S.LeadingVisual,{children:(0,i.jsx)(Z.VHe,{})}),e.name,(0,i.jsxs)(j.S.Description,{children:[e.mimeType," ",(0,v.Aq)(e.description)]})]},e.id)))})]})]}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(u.Z.Label,{children:"Solution Code"}),(0,i.jsx)(u.Z.Caption,{children:"This is the expected solution code. The student will never see this content."})]}),(0,i.jsx)(y.r,{showEditor:!0,autoRun:!0,kernel:_,id:"exercise-solution",code:K.codeSolution}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(u.Z.Label,{children:"Question code"}),(0,i.jsx)(u.Z.Caption,{children:"This the question code that will be shown to the student."})]}),(0,i.jsx)(y.r,{showEditor:!0,autoRun:!1,kernel:_,id:"exercise-question",code:K.codeQuestion}),(0,i.jsx)(l.Z,{children:(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(u.Z.Label,{children:"Help for the student"}),(0,i.jsx)(u.Z.Caption,{children:"This a help that will be shown to the student if he asks for it."}),(0,i.jsx)(p.ZP,{block:!0,value:Y.help,onChange:e=>{J((s=>({...s,help:e.target.value})))}}),!ee.help&&(0,i.jsx)(u.Z.Validation,{variant:"error",children:"Hint must have more than 2 characters"})]})}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(u.Z.Label,{children:"Test the Solution code"}),(0,i.jsxs)(u.Z.Caption,{children:["Write the test code that will be run on the student's code during the exercise. Please refer to the ",(0,i.jsx)(g.Z,{href:"https://nbgrader.readthedocs.io/en/latest/user_guide/autograding_resources.html",target:"_blank",children:"nbgrader"})," documentation."]})]}),(0,i.jsx)(y.r,{showEditor:!0,autoRun:!1,disableRun:!0,kernel:_,id:"exercise-test",code:K.codeTest})]}),(0,i.jsx)(m.Z,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:'Validate you tests with this button. It will run the "Preliminary code", then will run the "Test code" on the "Solution code". When a student will take the exercise, the "Test code" will be run on the "Student code".'}),(0,i.jsx)(h.r,{variant:"danger",leadingVisual:Z.Zi2,sx:{marginTop:2,marginBottom:2},onClick:e=>{e.preventDefault(),D.setExecuteRequest("exercise-test",`\nsetup_state(stu_code = """${K.codePre}\n${Q}""", sol_code = """${K.codePre}\n${F}""")\n${N}\n`)},children:"Test"}),(0,i.jsx)(m.Z,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:"Once you are confident with your test, you can create the exercise. Don't worry, you can still update it before making it public."}),(0,i.jsx)(h.r,{variant:"primary",disabled:!ee.name||!ee.description,sx:{marginTop:2},onClick:async()=>{I({id:K?.id,name:Y.name,description:Y.description,help:Y.help,codePre:A??"",codeSolution:F??"",codeQuestion:Q??"",codeTest:N??""}).then((e=>{e.success&&(G("The exercise is successfully updated.",{variant:"success"}),E.layout().triggerItemsRefresh())}))},children:"Update exercise"})]}),(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(c.Z,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,i.jsxs)(l.Z,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,display:"flex",alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,i.jsxs)(l.Z,{sx:{display:"grid",gap:1},children:[(0,i.jsx)(m.Z,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Delete exercise"}),(0,i.jsx)(m.Z,{sx:{fontSize:1,color:"fg.muted"},children:"Are you sure you don't want to just upgrade your account?"})]}),(0,i.jsx)(h.r,{variant:"danger",onClick:e=>O(!0),disabled:!0,children:"Delete exercise"})]})]})]})]})},S=C}}]);
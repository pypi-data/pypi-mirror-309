"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[8138],{28138:(e,s,t)=>{t.r(s),t.d(s,{LessonEdit:()=>Z,default:()=>b});var a=t(91896),r=t(56769),i=t(59886),o=t(36705),n=t(64506),l=t(81457),c=t(31728),d=t(13676),h=t(45775),u=t(55627),p=t(91228),m=t(87822),x=t(43275),y=t(27959),f=t(50314),j=t(20800),v=t(33642),k=t(67143),g=t(13565);const Z=()=>{const{lessonId:e}=(0,i.UO)();if(!e)return(0,a.jsx)(a.Fragment,{});const s=(0,k.aF)(),t=(0,o.N)(),Z=(0,k.s0)(),b=(0,g.qX)(),C=(0,y.qL)(),B=b.layout().space,L=(0,g.D1)().saveRequest,S=C.selectNotebookModel(e),{cloneLesson:N,getLesson:w,refreshLesson:I,updateNotebook:T,updateNotebookModel:E}=(0,k.YT)(),[P,R]=(0,r.useState)("editor"),{enqueueToast:q}=(0,k.pm)(),[D,F]=(0,r.useState)(),[_,M]=(0,r.useState)({name:"",description:""}),[O,V]=(0,r.useState)({name:void 0,description:void 0}),z=(e,s)=>{s.preventDefault(),b.layout().resetRightPortal(),R(e)};(0,r.useEffect)((()=>(b.layout().showBackdrop(),I(e).then((s=>{if(b.layout().hideBackdrop(),s.success){const s=w(e);s?(F(s),b.layout().setItem(s),M({name:s.name,description:s.description})):Z("/")}})).finally((()=>{b.layout().hideBackdrop()})),()=>{F(void 0),C.reset(),b.layout().setItem(void 0)})),[e]),(0,r.useEffect)((()=>{L&&D&&S?.model?.cells&&(b.layout().showBackdrop("Saving the lesson..."),E(e,S.model.toJSON()).then((e=>{e.success&&(q("The lesson is successfully updated.",{variant:"success"}),b.layout().triggerItemsRefresh(),F({...D,nbformat:S.model.toJSON()}))})).finally((()=>{b.layout().hideBackdrop()})))}),[L]),(0,r.useEffect)((()=>{V({...O,name:void 0===_.name?void 0:_.name.length>2,description:void 0===_.description?void 0:_.description.length>2})}),[_]);const J=(0,r.useCallback)((async a=>{t({title:"Are you sure?",content:"Please confirm you want to clone this lesson in your private library."}).then((t=>{t&&(b.layout().showBackdrop(),N(e).then((e=>{b.layout().hideBackdrop(),e.success&&(q(e.message,{variant:"success"}),b.layout().triggerItemsRefresh(),Z(`/${s?.handle}/library/lessons`))})).finally((()=>{b.layout().hideBackdrop()})))}))}),[t,D]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Z,{children:(0,a.jsxs)(l.Z,{display:"flex",children:[(0,a.jsx)(l.Z,{flex:1,children:(0,a.jsx)(c.Z,{sx:{fontSize:3},children:"Lesson editor"})}),"editor"===P&&(0,a.jsx)(l.Z,{children:(0,a.jsx)(v.Z$,{notebookId:e})}),D&&B&&(0,a.jsx)(l.Z,{children:(0,a.jsx)(d.r,{variant:"invisible",size:"small",leadingVisual:x.jcu,onClick:J,children:"Clone"})})]})}),D&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{sx:{mt:3,mb:3},children:[(0,a.jsx)(h.Z.Link,{href:"",selected:"editor"===P,onClick:e=>z("editor",e),children:"Editor"}),(0,a.jsx)(h.Z.Link,{href:"",selected:"properties"===P,onClick:e=>z("properties",e),children:"Properties"})]}),"editor"===P&&(0,a.jsx)(l.Z,{children:D.nbformat&&(0,a.jsx)(f.a,{id:e,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",cellMetadataPanel:!0,nbformat:D.nbformat,CellSidebar:j.Q})}),"properties"===P&&(0,a.jsx)(l.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,a.jsx)(l.Z,{children:(0,a.jsxs)(l.Z,{sx:{label:{marginTop:2}},children:[(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(u.Z.Label,{children:"Name"}),(0,a.jsx)(p.Z,{block:!0,value:_.name,onChange:e=>{M((s=>({...s,name:e.target.value})))}}),!1===O.name&&(0,a.jsx)(u.Z.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(u.Z.Label,{children:"Description"}),(0,a.jsx)(m.ZP,{block:!0,value:_.description,onChange:e=>{M((s=>({...s,description:e.target.value})))}}),!1===O.description&&(0,a.jsx)(u.Z.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,a.jsx)(u.Z,{children:(0,a.jsx)(d.r,{variant:"primary",disabled:!O.name||!O.description,sx:{marginTop:2},onClick:async()=>{b.layout().showBackdrop(),T(e,_.name,_.description).then((e=>{b.layout().hideBackdrop(),e.success&&(q("The lesson is successfully updated.",{variant:"success"}),b.layout().triggerItemsRefresh(),F({...D,name:_.name,description:_.description}))})).finally((()=>{b.layout().hideBackdrop()}))},children:"Update lesson"})})]})})})]})]})},b=Z}}]);
"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[1479],{51479:(e,t,s)=>{s.r(t),s.d(t,{ExerciseNew:()=>k,default:()=>C});var n=s(91896),i=s(56769),r=s(64506),a=s(31728),o=s(81457),c=s(55627),l=s(91228),d=s(87822),h=s(19171),u=s(58169),p=s(74151),x=s(13676),m=s(43275),g=s(3039),j=s(55230),b=s(83073),Z=s(72115);function v(e){const t=Z(e);if(0===t)return e;const s=new RegExp(`^[ \\t]{${t}}`,"gm");return e.replace(s,"")}var f=s(88174),w=s(67143),y=s(13565);const k=()=>{const e=(0,w.aF)(),t=(0,y.qX)(),s=(0,y.Ae)(),Z=(0,j.gQ)(),k=(0,w.s0)(),{enqueueToast:C}=(0,w.pm)(),{kernelManager:S,defaultKernel:T}=(0,g.W$)(),E=t.layout().leftSidebarVariant,_=t.layout().organization,D=t.layout().space,$=(0,i.useMemo)((()=>T),[S]),{getSpaceDatasets:q,refreshSpaceDatasets:L}=(0,w.YT)(),[R,P]=(0,i.useState)(q()),V=Z.outputs?.get("exercise-pre")?.input,z=Z.outputs?.get("exercise-solution")?.input,I=Z.outputs?.get("exercise-question")?.input,N=Z.outputs?.get("exercise-test")?.input,[W,A]=(0,i.useState)({name:void 0,description:void 0,help:'Use the assignment operator "=" to create the variable "x".'}),[F,H]=(0,i.useState)({name:void 0,description:void 0,help:!0});(0,i.useEffect)((()=>{D&&L(D,_).then((e=>{e.success&&P(q())}))}),[D]),(0,i.useEffect)((()=>{H({...F,name:void 0===W.name?void 0:W.name.length>2,description:void 0===W.description?void 0:W.description.length>2,help:void 0===W.help?void 0:W.help.length>2})}),[W]);const{isLoading:M,isSuccess:Q,uploadAndSubmit:B,progress:U}=(0,w.Wy)(`${s.configuration.spacerRunUrl}/api/spacer/v1/exercises`);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Z,{children:(0,n.jsx)(a.Z,{sx:{fontSize:3},children:"New Exercise"})}),(0,n.jsxs)(o.Z,{children:[(0,n.jsxs)(o.Z,{sx:{label:{marginTop:2},"label + span":{marginBottom:2}},children:[(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(c.Z.Label,{children:"Name"}),(0,n.jsx)(c.Z.Caption,{children:"Name of the exercise."}),(0,n.jsx)(l.Z,{block:!0,value:W.name,onChange:e=>{A((t=>({...t,name:e.target.value})))}}),!1===F.name&&(0,n.jsx)(c.Z.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(c.Z.Label,{children:"Description"}),(0,n.jsx)(c.Z.Caption,{children:"Description of the exercise."}),(0,n.jsx)(d.ZP,{block:!0,value:W.description,onChange:e=>{A((t=>({...t,description:e.target.value})))}}),!1===F.description&&(0,n.jsx)(c.Z.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,n.jsxs)(o.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:3,children:[(0,n.jsxs)(o.Z,{children:[(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(c.Z.Label,{children:"Preliminary code"}),(0,n.jsx)(c.Z.Caption,{children:"This is the preliminary code that will be run before the exercise is taken."})]}),(0,n.jsx)(b.r,{showEditor:!0,autoRun:!0,kernel:$,code:"# Insert your preliminary code here.",id:"exercise-pre"})]}),(0,n.jsxs)(o.Z,{children:[(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(c.Z.Label,{children:"Datasets"}),(0,n.jsx)(c.Z.Caption,{children:"Select the datasets to be used in the prelimary code."})]}),(0,n.jsx)(h.S,{showDividers:!0,role:"listbox","aria-label":"Select assignees",children:R.map((e=>(0,n.jsxs)(h.S.Item,{role:"option",onClick:t=>{t.preventDefault(),Z.setDataset("exercise-pre",e)},children:[(0,n.jsx)(h.S.LeadingVisual,{children:(0,n.jsx)(m.VHe,{})}),e.name,(0,n.jsxs)(h.S.Description,{children:[e.mimeType," ",(0,f.Aq)(e.description)]})]},e.id)))})]})]}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(c.Z.Label,{children:"Solution Code"}),(0,n.jsx)(c.Z.Caption,{children:"This is the expected solution code. The student will never see this content."})]}),(0,n.jsx)(b.r,{showEditor:!0,autoRun:!0,kernel:$,id:"exercise-solution",code:"# Create a variable x, equals to 3.\nx = 3\n\n# Print x.\nprint(x)"}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(c.Z.Label,{children:"Question code"}),(0,n.jsx)(c.Z.Caption,{children:"This the question code that will be shown to the student."})]}),(0,n.jsx)(b.r,{showEditor:!0,autoRun:!1,kernel:$,id:"exercise-question",code:v("# Create a variable x, equals to 3.\n...\n\n# Print x.\n...\n").trim()}),(0,n.jsx)(o.Z,{children:(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(c.Z.Label,{children:"Help for the student"}),(0,n.jsx)(c.Z.Caption,{children:"This a help that will be shown to the student if he asks for it."}),(0,n.jsx)(d.ZP,{block:!0,value:W.help,onChange:e=>{A((t=>({...t,help:e.target.value})))}}),!1===F.help&&(0,n.jsx)(c.Z.Validation,{variant:"error",children:"Help must have more than 2 characters"})]})}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(c.Z.Label,{children:"Test the Solution code"}),(0,n.jsxs)(c.Z.Caption,{children:["Write the test code that will be run on the student's code during the exercise. Please refer to the ",(0,n.jsx)(u.Z,{href:"https://nbgrader.readthedocs.io/en/latest/user_guide/autograding_resources.html",target:"_blank",children:"nbgrader"})," documentation."]})]}),(0,n.jsx)(b.r,{showEditor:!0,autoRun:!1,disableRun:!0,kernel:$,id:"exercise-test",code:'Ex().check_object("x")\nEx().check_object("x").has_equal_value()\nEx().has_output("3")\nprint(\'Congratulations. You have successfully passed this exercise.\')'})]}),(0,n.jsx)(p.Z,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:'Validate you tests with this button. It will run the "Preliminary code", then will run the "Test code" on the "Solution code". When a student will take the exercise, the "Test code" will be run on the "Student code".'}),(0,n.jsx)(x.r,{variant:"danger",leadingVisual:m.Zi2,sx:{marginTop:2,marginBottom:2},onClick:e=>{e.preventDefault(),Z.setExecuteRequest("exercise-test",`\nsetup_state(stu_code = """${V}\n${z}""", sol_code = """${V}\n${z}""")\n${N}\n`)},children:"Test"}),(0,n.jsx)(p.Z,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:"Once you are confident with your test, you can create the exercise. Don't worry, you can still update it before making it public."}),(0,n.jsx)(x.r,{variant:"primary",disabled:M||!F.name||!F.description,sx:{marginTop:2},onClick:async()=>{const s=new FormData;s.append("name",W.name),s.append("description",W.description),s.append("help",W.help),s.append("codePre",V??""),s.append("codeSolution",z??""),s.append("codeQuestion",I??""),s.append("codeTest",N??""),s.append("accountType","organization-space"===E?"organization":"user"),s.append("accountId","organization-space"===E?_?.id:e?.id),s.append("spaceId",D?.id),B(s).then((s=>{s.success&&(C("The exercise has been created.",{variant:"success"}),"organization"===E||"organization-space"===E?(k(`/${_?.handle}/${D?.handle}/exercise/${s.exercise.uid}`),t.layout().triggerItemsRefresh()):k(`/${e?.handle}/${D?.handle}/exercises`))}))},children:"Create an exercise"})]})]})},C=k},72115:e=>{e.exports=e=>{const t=e.match(/^[ \t]*(?=\S)/gm);return t?t.reduce(((e,t)=>Math.min(e,t.length)),1/0):0}}}]);
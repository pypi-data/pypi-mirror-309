"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[3691],{63691:(e,t,s)=>{s.r(t),s.d(t,{ExerciseEdit:()=>p,default:()=>m});var r=s(74512),o=s(66029),n=s(99608),i=s(40809),a=s(23189),l=s(90180),c=s(55745),d=s(7749),h=s(19409),u=s(26103),x=s(69058);const p=()=>{const{accountHandle:e,spaceHandle:t,exerciseId:s}=(0,n.UO)();if(!s)return(0,r.jsx)(r.Fragment,{});const p=(0,h.aF)(),{kernelManager:m,defaultKernel:j}=(0,l.useJupyter)(),g=(0,x.qX)(),C=((0,x.Ae)(),(0,c.gQ)()),f=g.layout().organization,b=g.layout().space,y=(0,o.useMemo)((()=>j),[m]),{cloneExercise:F,getExercise:k,getSpaceDatasets:T,refreshExercise:v,refreshSpaceDatasets:w,updateExercise:B}=(0,h.YT)(),[S,E]=(0,o.useState)(T()),D=C.outputs?.get("exercise-pre")?.input,L=C.outputs?.get("exercise-solution")?.input,_=C.outputs?.get("exercise-question")?.input,P=C.outputs?.get("exercise-test")?.input,R=(0,i.useConfirm)(),[$,z]=(0,o.useState)(!1),A=(0,h.s0)(),{enqueueToast:I}=(0,h.pm)(),[V,q]=(0,o.useState)();(0,o.useEffect)((()=>{v(s).then((e=>{if(e.success){const e=k(s);e?(q(e),g.layout().setItem(e),Q((t=>({...t,name:e.name,description:e.description,help:e.help})))):A("/")}}))}),[s]),(0,o.useEffect)((()=>{b&&w(b,f).then((e=>{e.success&&E(T())}))}),[b]);const[H,Q]=(0,o.useState)({name:"",description:"",help:'Use the assignment operator "=" to create the variable "x".'}),[W,U]=(0,o.useState)({name:!1,description:!1,help:!0});(0,o.useEffect)((()=>{U({...W,name:H.name.length>2,description:H.description.length>2})}),[H]);const G=(0,o.useCallback)((async e=>{R({title:"Are you sure?",content:"Please confirm you want to clone this exercise in your private library."}).then((e=>{e&&F(s).then((e=>{e.success&&(I(e.message,{variant:"success"}),g.layout().triggerItemsRefresh(),A(`/${p?.handle}/library/exercises`))}))}))}),[R,V]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Pagehead,{children:(0,r.jsxs)(i.Box,{display:"flex",children:[(0,r.jsx)(i.Box,{flex:1,children:(0,r.jsx)(i.Heading,{sx:{fontSize:3},children:"Exercise editor"})}),(0,r.jsx)(i.Box,{children:(0,r.jsxs)(i.ButtonGroup,{children:[(0,r.jsx)(i.Button,{variant:"default",size:"small",onClick:()=>A(`/${e}/${t}/exercise/${V?.id}/take`),children:"Take this exercise"}),b&&(0,r.jsx)(i.Button,{variant:"default",size:"small",leadingVisual:a.jcu,onClick:G,children:"Clone"})]})})]})}),V&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.Box,{children:[(0,r.jsxs)(i.Box,{sx:{label:{marginTop:2}},children:[(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Name"}),(0,r.jsx)(i.TextInput,{block:!0,value:H.name,onChange:e=>{Q((t=>({...t,name:e.target.value})))}}),!W.name&&(0,r.jsx)(i.FormControl.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Description"}),(0,r.jsx)(i.Textarea,{block:!0,value:H.description,onChange:e=>{Q((t=>({...t,description:e.target.value})))}}),!W.description&&(0,r.jsx)(i.FormControl.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,r.jsxs)(i.Box,{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:3,children:[(0,r.jsxs)(i.Box,{children:[(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Preliminary code"}),(0,r.jsx)(i.FormControl.Caption,{children:"This is the preliminary code that will be run before the exercise is taken."})]}),(0,r.jsx)(d.r,{showEditor:!0,autoRun:!0,kernel:y,code:V.codePre,id:"exercise-pre"})]}),(0,r.jsxs)(i.Box,{children:[(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Datasets"}),(0,r.jsx)(i.FormControl.Caption,{children:"Select the datasets to be used in the prelimary code."})]}),(0,r.jsx)(i.ActionList,{showDividers:!0,role:"listbox","aria-label":"Select assignees",children:S.map((e=>(0,r.jsxs)(i.ActionList.Item,{role:"option",onClick:t=>{t.preventDefault(),C.setDataset("exercise-pre",e)},children:[(0,r.jsx)(i.ActionList.LeadingVisual,{children:(0,r.jsx)(a.VHe,{})}),e.name,(0,r.jsxs)(i.ActionList.Description,{children:[e.mimeType," ",(0,u.Aq)(e.description)]})]},e.id)))})]})]}),(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Solution Code"}),(0,r.jsx)(i.FormControl.Caption,{children:"This is the expected solution code. The student will never see this content."})]}),(0,r.jsx)(d.r,{showEditor:!0,autoRun:!0,kernel:y,id:"exercise-solution",code:V.codeSolution}),(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Question code"}),(0,r.jsx)(i.FormControl.Caption,{children:"This the question code that will be shown to the student."})]}),(0,r.jsx)(d.r,{showEditor:!0,autoRun:!1,kernel:y,id:"exercise-question",code:V.codeQuestion}),(0,r.jsx)(i.Box,{children:(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Help for the student"}),(0,r.jsx)(i.FormControl.Caption,{children:"This a help that will be shown to the student if he asks for it."}),(0,r.jsx)(i.Textarea,{block:!0,value:H.help,onChange:e=>{Q((t=>({...t,help:e.target.value})))}}),!W.help&&(0,r.jsx)(i.FormControl.Validation,{variant:"error",children:"Hint must have more than 2 characters"})]})}),(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Test the Solution code"}),(0,r.jsxs)(i.FormControl.Caption,{children:["Write the test code that will be run on the student's code during the exercise. Please refer to the ",(0,r.jsx)(i.Link,{href:"https://nbgrader.readthedocs.io/en/latest/user_guide/autograding_resources.html",target:"_blank",children:"nbgrader"})," documentation."]})]}),(0,r.jsx)(d.r,{showEditor:!0,autoRun:!1,disableRun:!0,kernel:y,id:"exercise-test",code:V.codeTest})]}),(0,r.jsx)(i.Text,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:'Validate you tests with this button. It will run the "Preliminary code", then will run the "Test code" on the "Solution code". When a student will take the exercise, the "Test code" will be run on the "Student code".'}),(0,r.jsx)(i.Button,{variant:"danger",leadingVisual:a.Zi2,sx:{marginTop:2,marginBottom:2},onClick:e=>{e.preventDefault(),C.setExecuteRequest("exercise-test",`\nsetup_state(stu_code = """${V.codePre}\n${_}""", sol_code = """${V.codePre}\n${L}""")\n${P}\n`)},children:"Test"}),(0,r.jsx)(i.Text,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:"Once you are confident with your test, you can create the exercise. Don't worry, you can still update it before making it public."}),(0,r.jsx)(i.Button,{variant:"primary",disabled:!W.name||!W.description,sx:{marginTop:2},onClick:async()=>{B({id:V?.id,name:H.name,description:H.description,help:H.help,codePre:D??"",codeSolution:L??"",codeQuestion:_??"",codeTest:P??""}).then((e=>{e.success&&(I("The exercise is successfully updated.",{variant:"success"}),g.layout().triggerItemsRefresh())}))},children:"Update exercise"})]}),(0,r.jsxs)(i.Box,{children:[(0,r.jsx)(i.Heading,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,r.jsxs)(i.Box,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,display:"flex",alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,r.jsxs)(i.Box,{sx:{display:"grid",gap:1},children:[(0,r.jsx)(i.Text,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Delete exercise"}),(0,r.jsx)(i.Text,{sx:{fontSize:1,color:"fg.muted"},children:"Are you sure you don't want to just upgrade your account?"})]}),(0,r.jsx)(i.Button,{variant:"danger",onClick:e=>z(!0),disabled:!0,children:"Delete exercise"})]})]})]})]})},m=p}}]);
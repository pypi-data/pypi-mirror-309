"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[299],{299:(e,t,n)=>{n.r(t),n.d(t,{ExerciseNew:()=>g,default:()=>j});var r=n(74512),o=n(66029),s=n(40809),i=n(23189),a=n(90180),l=n(55745),c=n(7749),d=n(41877),h=n.n(d);function u(e){const t=h()(e);if(0===t)return e;const n=new RegExp(`^[ \\t]{${t}}`,"gm");return e.replace(n,"")}var p=n(26103),x=n(19409),m=n(69058);const g=()=>{const e=(0,x.aF)(),t=(0,m.qX)(),n=(0,m.Ae)(),d=(0,l.gQ)(),h=(0,x.s0)(),{enqueueToast:g}=(0,x.pm)(),{kernelManager:j,defaultKernel:C}=(0,a.useJupyter)(),b=t.layout().leftSidebarVariant,v=t.layout().organization,f=t.layout().space,F=(0,o.useMemo)((()=>C),[j]),{getSpaceDatasets:y,refreshSpaceDatasets:w}=(0,x.YT)(),[T,k]=(0,o.useState)(y()),S=d.outputs?.get("exercise-pre")?.input,E=d.outputs?.get("exercise-solution")?.input,L=d.outputs?.get("exercise-question")?.input,_=d.outputs?.get("exercise-test")?.input,[D,$]=(0,o.useState)({name:void 0,description:void 0,help:'Use the assignment operator "=" to create the variable "x".'}),[q,B]=(0,o.useState)({name:void 0,description:void 0,help:!0});(0,o.useEffect)((()=>{f&&w(f,v).then((e=>{e.success&&k(y())}))}),[f]),(0,o.useEffect)((()=>{B({...q,name:void 0===D.name?void 0:D.name.length>2,description:void 0===D.description?void 0:D.description.length>2,help:void 0===D.help?void 0:D.help.length>2})}),[D]);const{isLoading:R,isSuccess:V,uploadAndSubmit:z,progress:A}=(0,x.Wy)(`${n.configuration.spacerRunUrl}/api/spacer/v1/exercises`);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Pagehead,{children:(0,r.jsx)(s.Heading,{sx:{fontSize:3},children:"New Exercise"})}),(0,r.jsxs)(s.Box,{children:[(0,r.jsxs)(s.Box,{sx:{label:{marginTop:2},"label + span":{marginBottom:2}},children:[(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Name"}),(0,r.jsx)(s.FormControl.Caption,{children:"Name of the exercise."}),(0,r.jsx)(s.TextInput,{block:!0,value:D.name,onChange:e=>{$((t=>({...t,name:e.target.value})))}}),!1===q.name&&(0,r.jsx)(s.FormControl.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Description"}),(0,r.jsx)(s.FormControl.Caption,{children:"Description of the exercise."}),(0,r.jsx)(s.Textarea,{block:!0,value:D.description,onChange:e=>{$((t=>({...t,description:e.target.value})))}}),!1===q.description&&(0,r.jsx)(s.FormControl.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,r.jsxs)(s.Box,{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:3,children:[(0,r.jsxs)(s.Box,{children:[(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Preliminary code"}),(0,r.jsx)(s.FormControl.Caption,{children:"This is the preliminary code that will be run before the exercise is taken."})]}),(0,r.jsx)(c.r,{showEditor:!0,autoRun:!0,kernel:F,code:"# Insert your preliminary code here.",id:"exercise-pre"})]}),(0,r.jsxs)(s.Box,{children:[(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Datasets"}),(0,r.jsx)(s.FormControl.Caption,{children:"Select the datasets to be used in the prelimary code."})]}),(0,r.jsx)(s.ActionList,{showDividers:!0,role:"listbox","aria-label":"Select assignees",children:T.map((e=>(0,r.jsxs)(s.ActionList.Item,{role:"option",onClick:t=>{t.preventDefault(),d.setDataset("exercise-pre",e)},children:[(0,r.jsx)(s.ActionList.LeadingVisual,{children:(0,r.jsx)(i.VHe,{})}),e.name,(0,r.jsxs)(s.ActionList.Description,{children:[e.mimeType," ",(0,p.Aq)(e.description)]})]},e.id)))})]})]}),(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Solution Code"}),(0,r.jsx)(s.FormControl.Caption,{children:"This is the expected solution code. The student will never see this content."})]}),(0,r.jsx)(c.r,{showEditor:!0,autoRun:!0,kernel:F,id:"exercise-solution",code:"# Create a variable x, equals to 3.\nx = 3\n\n# Print x.\nprint(x)"}),(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Question code"}),(0,r.jsx)(s.FormControl.Caption,{children:"This the question code that will be shown to the student."})]}),(0,r.jsx)(c.r,{showEditor:!0,autoRun:!1,kernel:F,id:"exercise-question",code:u("# Create a variable x, equals to 3.\n...\n\n# Print x.\n...\n").trim()}),(0,r.jsx)(s.Box,{children:(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Help for the student"}),(0,r.jsx)(s.FormControl.Caption,{children:"This a help that will be shown to the student if he asks for it."}),(0,r.jsx)(s.Textarea,{block:!0,value:D.help,onChange:e=>{$((t=>({...t,help:e.target.value})))}}),!1===q.help&&(0,r.jsx)(s.FormControl.Validation,{variant:"error",children:"Help must have more than 2 characters"})]})}),(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Test the Solution code"}),(0,r.jsxs)(s.FormControl.Caption,{children:["Write the test code that will be run on the student's code during the exercise. Please refer to the ",(0,r.jsx)(s.Link,{href:"https://nbgrader.readthedocs.io/en/latest/user_guide/autograding_resources.html",target:"_blank",children:"nbgrader"})," documentation."]})]}),(0,r.jsx)(c.r,{showEditor:!0,autoRun:!1,disableRun:!0,kernel:F,id:"exercise-test",code:'Ex().check_object("x")\nEx().check_object("x").has_equal_value()\nEx().has_output("3")\nprint(\'Congratulations. You have successfully passed this exercise.\')'})]}),(0,r.jsx)(s.Text,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:'Validate you tests with this button. It will run the "Preliminary code", then will run the "Test code" on the "Solution code". When a student will take the exercise, the "Test code" will be run on the "Student code".'}),(0,r.jsx)(s.Button,{variant:"danger",leadingVisual:i.Zi2,sx:{marginTop:2,marginBottom:2},onClick:e=>{e.preventDefault(),d.setExecuteRequest("exercise-test",`\nsetup_state(stu_code = """${S}\n${E}""", sol_code = """${S}\n${E}""")\n${_}\n`)},children:"Test"}),(0,r.jsx)(s.Text,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:"Once you are confident with your test, you can create the exercise. Don't worry, you can still update it before making it public."}),(0,r.jsx)(s.Button,{variant:"primary",disabled:R||!q.name||!q.description,sx:{marginTop:2},onClick:async()=>{const n=new FormData;n.append("name",D.name),n.append("description",D.description),n.append("help",D.help),n.append("codePre",S??""),n.append("codeSolution",E??""),n.append("codeQuestion",L??""),n.append("codeTest",_??""),n.append("accountType","organization-space"===b?"organization":"user"),n.append("accountId","organization-space"===b?v?.id:e?.id),n.append("spaceId",f?.id),z(n).then((n=>{n.success&&(g("The exercise has been created.",{variant:"success"}),"organization"===b||"organization-space"===b?(h(`/${v?.handle}/${f?.handle}/exercise/${n.exercise.uid}`),t.layout().triggerItemsRefresh()):h(`/${e?.handle}/${f?.handle}/exercises`))}))},children:"Create an exercise"})]})]})},j=g},41877:e=>{e.exports=e=>{const t=e.match(/^[ \t]*(?=\S)/gm);return t?t.reduce(((e,t)=>Math.min(e,t.length)),1/0):0}}}]);
"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[8420],{27574:(e,t,s)=>{s.d(t,{A:()=>o});var i=s(57991);var n=s(63221);const r=(e,t)=>i.A.lang.round(n.A.parse(e)[t]);const o=r},97134:(e,t,s)=>{s.d(t,{A:()=>o});var i=s(40295);var n=4;function r(e){return(0,i.A)(e,n)}const o=r},68420:(e,t,s)=>{s.d(t,{diagram:()=>xe});var i=s(75747);var n=s(97134);var r=s(27574);var o=s(3635);var l=s(89437);var a=s(84416);var c=s(92935);var u=s(74353);var h=s.n(u);var d=s(16750);var g=s(42838);var y=s.n(g);var p,b;var f=function(){var e=function(e,t,s,i){for(s=s||{},i=e.length;i--;s[e[i]]=t);return s},t=[1,7],s=[1,13],i=[1,14],n=[1,15],r=[1,19],o=[1,16],l=[1,17],a=[1,18],c=[8,30],u=[8,21,28,29,30,31,32,40,44,47],h=[1,23],d=[1,24],g=[8,15,16,21,28,29,30,31,32,40,44,47],y=[8,15,16,21,27,28,29,30,31,32,40,44,47],p=[1,49];var b={trace:function e(){},yy:{},symbols_:{error:2,spaceLines:3,SPACELINE:4,NL:5,separator:6,SPACE:7,EOF:8,start:9,BLOCK_DIAGRAM_KEY:10,document:11,stop:12,statement:13,link:14,LINK:15,START_LINK:16,LINK_LABEL:17,STR:18,nodeStatement:19,columnsStatement:20,SPACE_BLOCK:21,blockStatement:22,classDefStatement:23,cssClassStatement:24,styleStatement:25,node:26,SIZE:27,COLUMNS:28,"id-block":29,end:30,block:31,NODE_ID:32,nodeShapeNLabel:33,dirList:34,DIR:35,NODE_DSTART:36,NODE_DEND:37,BLOCK_ARROW_START:38,BLOCK_ARROW_END:39,classDef:40,CLASSDEF_ID:41,CLASSDEF_STYLEOPTS:42,DEFAULT:43,class:44,CLASSENTITY_IDS:45,STYLECLASS:46,style:47,STYLE_ENTITY_IDS:48,STYLE_DEFINITION_DATA:49,$accept:0,$end:1},terminals_:{2:"error",4:"SPACELINE",5:"NL",7:"SPACE",8:"EOF",10:"BLOCK_DIAGRAM_KEY",15:"LINK",16:"START_LINK",17:"LINK_LABEL",18:"STR",21:"SPACE_BLOCK",27:"SIZE",28:"COLUMNS",29:"id-block",30:"end",31:"block",32:"NODE_ID",35:"DIR",36:"NODE_DSTART",37:"NODE_DEND",38:"BLOCK_ARROW_START",39:"BLOCK_ARROW_END",40:"classDef",41:"CLASSDEF_ID",42:"CLASSDEF_STYLEOPTS",43:"DEFAULT",44:"class",45:"CLASSENTITY_IDS",46:"STYLECLASS",47:"style",48:"STYLE_ENTITY_IDS",49:"STYLE_DEFINITION_DATA"},productions_:[0,[3,1],[3,2],[3,2],[6,1],[6,1],[6,1],[9,3],[12,1],[12,1],[12,2],[12,2],[11,1],[11,2],[14,1],[14,4],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[19,3],[19,2],[19,1],[20,1],[22,4],[22,3],[26,1],[26,2],[34,1],[34,2],[33,3],[33,4],[23,3],[23,3],[24,3],[25,3]],performAction:function e(t,s,i,n,r,o,l){var a=o.length-1;switch(r){case 4:n.getLogger().debug("Rule: separator (NL) ");break;case 5:n.getLogger().debug("Rule: separator (Space) ");break;case 6:n.getLogger().debug("Rule: separator (EOF) ");break;case 7:n.getLogger().debug("Rule: hierarchy: ",o[a-1]);n.setHierarchy(o[a-1]);break;case 8:n.getLogger().debug("Stop NL ");break;case 9:n.getLogger().debug("Stop EOF ");break;case 10:n.getLogger().debug("Stop NL2 ");break;case 11:n.getLogger().debug("Stop EOF2 ");break;case 12:n.getLogger().debug("Rule: statement: ",o[a]);typeof o[a].length==="number"?this.$=o[a]:this.$=[o[a]];break;case 13:n.getLogger().debug("Rule: statement #2: ",o[a-1]);this.$=[o[a-1]].concat(o[a]);break;case 14:n.getLogger().debug("Rule: link: ",o[a],t);this.$={edgeTypeStr:o[a],label:""};break;case 15:n.getLogger().debug("Rule: LABEL link: ",o[a-3],o[a-1],o[a]);this.$={edgeTypeStr:o[a],label:o[a-1]};break;case 18:const e=parseInt(o[a]);const s=n.generateId();this.$={id:s,type:"space",label:"",width:e,children:[]};break;case 23:n.getLogger().debug("Rule: (nodeStatement link node) ",o[a-2],o[a-1],o[a]," typestr: ",o[a-1].edgeTypeStr);const i=n.edgeStrToEdgeData(o[a-1].edgeTypeStr);this.$=[{id:o[a-2].id,label:o[a-2].label,type:o[a-2].type,directions:o[a-2].directions},{id:o[a-2].id+"-"+o[a].id,start:o[a-2].id,end:o[a].id,label:o[a-1].label,type:"edge",directions:o[a].directions,arrowTypeEnd:i,arrowTypeStart:"arrow_open"},{id:o[a].id,label:o[a].label,type:n.typeStr2Type(o[a].typeStr),directions:o[a].directions}];break;case 24:n.getLogger().debug("Rule: nodeStatement (abc88 node size) ",o[a-1],o[a]);this.$={id:o[a-1].id,label:o[a-1].label,type:n.typeStr2Type(o[a-1].typeStr),directions:o[a-1].directions,widthInColumns:parseInt(o[a],10)};break;case 25:n.getLogger().debug("Rule: nodeStatement (node) ",o[a]);this.$={id:o[a].id,label:o[a].label,type:n.typeStr2Type(o[a].typeStr),directions:o[a].directions,widthInColumns:1};break;case 26:n.getLogger().debug("APA123",this?this:"na");n.getLogger().debug("COLUMNS: ",o[a]);this.$={type:"column-setting",columns:o[a]==="auto"?-1:parseInt(o[a])};break;case 27:n.getLogger().debug("Rule: id-block statement : ",o[a-2],o[a-1]);n.generateId();this.$={...o[a-2],type:"composite",children:o[a-1]};break;case 28:n.getLogger().debug("Rule: blockStatement : ",o[a-2],o[a-1],o[a]);const r=n.generateId();this.$={id:r,type:"composite",label:"",children:o[a-1]};break;case 29:n.getLogger().debug("Rule: node (NODE_ID separator): ",o[a]);this.$={id:o[a]};break;case 30:n.getLogger().debug("Rule: node (NODE_ID nodeShapeNLabel separator): ",o[a-1],o[a]);this.$={id:o[a-1],label:o[a].label,typeStr:o[a].typeStr,directions:o[a].directions};break;case 31:n.getLogger().debug("Rule: dirList: ",o[a]);this.$=[o[a]];break;case 32:n.getLogger().debug("Rule: dirList: ",o[a-1],o[a]);this.$=[o[a-1]].concat(o[a]);break;case 33:n.getLogger().debug("Rule: nodeShapeNLabel: ",o[a-2],o[a-1],o[a]);this.$={typeStr:o[a-2]+o[a],label:o[a-1]};break;case 34:n.getLogger().debug("Rule: BLOCK_ARROW nodeShapeNLabel: ",o[a-3],o[a-2]," #3:",o[a-1],o[a]);this.$={typeStr:o[a-3]+o[a],label:o[a-2],directions:o[a-1]};break;case 35:case 36:this.$={type:"classDef",id:o[a-1].trim(),css:o[a].trim()};break;case 37:this.$={type:"applyClass",id:o[a-1].trim(),styleClass:o[a].trim()};break;case 38:this.$={type:"applyStyles",id:o[a-1].trim(),stylesStr:o[a].trim()};break}},table:[{9:1,10:[1,2]},{1:[3]},{11:3,13:4,19:5,20:6,21:t,22:8,23:9,24:10,25:11,26:12,28:s,29:i,31:n,32:r,40:o,44:l,47:a},{8:[1,20]},e(c,[2,12],{13:4,19:5,20:6,22:8,23:9,24:10,25:11,26:12,11:21,21:t,28:s,29:i,31:n,32:r,40:o,44:l,47:a}),e(u,[2,16],{14:22,15:h,16:d}),e(u,[2,17]),e(u,[2,18]),e(u,[2,19]),e(u,[2,20]),e(u,[2,21]),e(u,[2,22]),e(g,[2,25],{27:[1,25]}),e(u,[2,26]),{19:26,26:12,32:r},{11:27,13:4,19:5,20:6,21:t,22:8,23:9,24:10,25:11,26:12,28:s,29:i,31:n,32:r,40:o,44:l,47:a},{41:[1,28],43:[1,29]},{45:[1,30]},{48:[1,31]},e(y,[2,29],{33:32,36:[1,33],38:[1,34]}),{1:[2,7]},e(c,[2,13]),{26:35,32:r},{32:[2,14]},{17:[1,36]},e(g,[2,24]),{11:37,13:4,14:22,15:h,16:d,19:5,20:6,21:t,22:8,23:9,24:10,25:11,26:12,28:s,29:i,31:n,32:r,40:o,44:l,47:a},{30:[1,38]},{42:[1,39]},{42:[1,40]},{46:[1,41]},{49:[1,42]},e(y,[2,30]),{18:[1,43]},{18:[1,44]},e(g,[2,23]),{18:[1,45]},{30:[1,46]},e(u,[2,28]),e(u,[2,35]),e(u,[2,36]),e(u,[2,37]),e(u,[2,38]),{37:[1,47]},{34:48,35:p},{15:[1,50]},e(u,[2,27]),e(y,[2,33]),{39:[1,51]},{34:52,35:p,39:[2,31]},{32:[2,15]},e(y,[2,34]),{39:[2,32]}],defaultActions:{20:[2,7],23:[2,14],50:[2,15],52:[2,32]},parseError:function e(t,s){if(s.recoverable){this.trace(t)}else{var i=new Error(t);i.hash=s;throw i}},parse:function e(t){var s=this,i=[0],n=[],r=[null],o=[],l=this.table,a="",c=0,u=0,h=2,d=1;var g=o.slice.call(arguments,1);var y=Object.create(this.lexer);var p={yy:{}};for(var b in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,b)){p.yy[b]=this.yy[b]}}y.setInput(t,p.yy);p.yy.lexer=y;p.yy.parser=this;if(typeof y.yylloc=="undefined"){y.yylloc={}}var f=y.yylloc;o.push(f);var x=y.options&&y.options.ranges;if(typeof p.yy.parseError==="function"){this.parseError=p.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function L(){var e;e=n.pop()||y.lex()||d;if(typeof e!=="number"){if(e instanceof Array){n=e;e=n.pop()}e=s.symbols_[e]||e}return e}var S,_,m,k,E={},v,D,w,N;while(true){_=i[i.length-1];if(this.defaultActions[_]){m=this.defaultActions[_]}else{if(S===null||typeof S=="undefined"){S=L()}m=l[_]&&l[_][S]}if(typeof m==="undefined"||!m.length||!m[0]){var $="";N=[];for(v in l[_]){if(this.terminals_[v]&&v>h){N.push("'"+this.terminals_[v]+"'")}}if(y.showPosition){$="Parse error on line "+(c+1)+":\n"+y.showPosition()+"\nExpecting "+N.join(", ")+", got '"+(this.terminals_[S]||S)+"'"}else{$="Parse error on line "+(c+1)+": Unexpected "+(S==d?"end of input":"'"+(this.terminals_[S]||S)+"'")}this.parseError($,{text:y.match,token:this.terminals_[S]||S,line:y.yylineno,loc:f,expected:N})}if(m[0]instanceof Array&&m.length>1){throw new Error("Parse Error: multiple actions possible at state: "+_+", token: "+S)}switch(m[0]){case 1:i.push(S);r.push(y.yytext);o.push(y.yylloc);i.push(m[1]);S=null;{u=y.yyleng;a=y.yytext;c=y.yylineno;f=y.yylloc}break;case 2:D=this.productions_[m[1]][1];E.$=r[r.length-D];E._$={first_line:o[o.length-(D||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(D||1)].first_column,last_column:o[o.length-1].last_column};if(x){E._$.range=[o[o.length-(D||1)].range[0],o[o.length-1].range[1]]}k=this.performAction.apply(E,[a,u,c,p.yy,m[1],r,o].concat(g));if(typeof k!=="undefined"){return k}if(D){i=i.slice(0,-1*D*2);r=r.slice(0,-1*D);o=o.slice(0,-1*D)}i.push(this.productions_[m[1]][0]);r.push(E.$);o.push(E._$);w=l[i[i.length-2]][i[i.length-1]];i.push(w);break;case 3:return true}}return true}};var f=function(){var e={EOF:1,parseError:function e(t,s){if(this.yy.parser){this.yy.parser.parseError(t,s)}else{throw new Error(t)}},setInput:function(e,t){this.yy=t||this.yy||{};this._input=e;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var e=this._input[0];this.yytext+=e;this.yyleng++;this.offset++;this.match+=e;this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);if(t){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return e},unput:function(e){var t=e.length;var s=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-t);this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(s.length-1){this.yylineno-=s.length-1}var n=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:s?(s.length===i.length?this.yylloc.first_column:0)+i[i.length-s.length].length-s[0].length:this.yylloc.first_column-t};if(this.options.ranges){this.yylloc.range=[n[0],n[0]+this.yyleng-t]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;if(e.length<20){e+=this._input.substr(0,20-e.length)}return(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput();var t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var s,i,n;if(this.options.backtrack_lexer){n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){n.yylloc.range=this.yylloc.range.slice(0)}}i=e[0].match(/(?:\r\n?|\n).*/g);if(i){this.yylineno+=i.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length};this.yytext+=e[0];this.match+=e[0];this.matches=e;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(e[0].length);this.matched+=e[0];s=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(s){return s}else if(this._backtrack){for(var r in n){this[r]=n[r]}return false}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var e,t,s,i;if(!this._more){this.yytext="";this.match=""}var n=this._currentRules();for(var r=0;r<n.length;r++){s=this._input.match(this.rules[n[r]]);if(s&&(!t||s[0].length>t[0].length)){t=s;i=r;if(this.options.backtrack_lexer){e=this.test_match(s,n[r]);if(e!==false){return e}else if(this._backtrack){t=false;continue}else{return false}}else if(!this.options.flex){break}}}if(t){e=this.test_match(t,n[i]);if(e!==false){return e}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function e(){var t=this.next();if(t){return t}else{return this.lex()}},begin:function e(t){this.conditionStack.push(t)},popState:function e(){var t=this.conditionStack.length-1;if(t>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function e(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions["INITIAL"].rules}},topState:function e(t){t=this.conditionStack.length-1-Math.abs(t||0);if(t>=0){return this.conditionStack[t]}else{return"INITIAL"}},pushState:function e(t){this.begin(t)},stateStackSize:function e(){return this.conditionStack.length},options:{},performAction:function e(t,s,i,n){switch(i){case 0:return 10;case 1:t.getLogger().debug("Found space-block");return 31;case 2:t.getLogger().debug("Found nl-block");return 31;case 3:t.getLogger().debug("Found space-block");return 29;case 4:t.getLogger().debug(".",s.yytext);break;case 5:t.getLogger().debug("_",s.yytext);break;case 6:return 5;case 7:s.yytext=-1;return 28;case 8:s.yytext=s.yytext.replace(/columns\s+/,"");t.getLogger().debug("COLUMNS (LEX)",s.yytext);return 28;case 9:this.pushState("md_string");break;case 10:return"MD_STR";case 11:this.popState();break;case 12:this.pushState("string");break;case 13:t.getLogger().debug("LEX: POPPING STR:",s.yytext);this.popState();break;case 14:t.getLogger().debug("LEX: STR end:",s.yytext);return"STR";case 15:s.yytext=s.yytext.replace(/space\:/,"");t.getLogger().debug("SPACE NUM (LEX)",s.yytext);return 21;case 16:s.yytext="1";t.getLogger().debug("COLUMNS (LEX)",s.yytext);return 21;case 17:return 43;case 18:return"LINKSTYLE";case 19:return"INTERPOLATE";case 20:this.pushState("CLASSDEF");return 40;case 21:this.popState();this.pushState("CLASSDEFID");return"DEFAULT_CLASSDEF_ID";case 22:this.popState();this.pushState("CLASSDEFID");return 41;case 23:this.popState();return 42;case 24:this.pushState("CLASS");return 44;case 25:this.popState();this.pushState("CLASS_STYLE");return 45;case 26:this.popState();return 46;case 27:this.pushState("STYLE_STMNT");return 47;case 28:this.popState();this.pushState("STYLE_DEFINITION");return 48;case 29:this.popState();return 49;case 30:this.pushState("acc_title");return"acc_title";case 31:this.popState();return"acc_title_value";case 32:this.pushState("acc_descr");return"acc_descr";case 33:this.popState();return"acc_descr_value";case 34:this.pushState("acc_descr_multiline");break;case 35:this.popState();break;case 36:return"acc_descr_multiline_value";case 37:return 30;case 38:this.popState();t.getLogger().debug("Lex: ((");return"NODE_DEND";case 39:this.popState();t.getLogger().debug("Lex: ((");return"NODE_DEND";case 40:this.popState();t.getLogger().debug("Lex: ))");return"NODE_DEND";case 41:this.popState();t.getLogger().debug("Lex: ((");return"NODE_DEND";case 42:this.popState();t.getLogger().debug("Lex: ((");return"NODE_DEND";case 43:this.popState();t.getLogger().debug("Lex: (-");return"NODE_DEND";case 44:this.popState();t.getLogger().debug("Lex: -)");return"NODE_DEND";case 45:this.popState();t.getLogger().debug("Lex: ((");return"NODE_DEND";case 46:this.popState();t.getLogger().debug("Lex: ]]");return"NODE_DEND";case 47:this.popState();t.getLogger().debug("Lex: (");return"NODE_DEND";case 48:this.popState();t.getLogger().debug("Lex: ])");return"NODE_DEND";case 49:this.popState();t.getLogger().debug("Lex: /]");return"NODE_DEND";case 50:this.popState();t.getLogger().debug("Lex: /]");return"NODE_DEND";case 51:this.popState();t.getLogger().debug("Lex: )]");return"NODE_DEND";case 52:this.popState();t.getLogger().debug("Lex: )");return"NODE_DEND";case 53:this.popState();t.getLogger().debug("Lex: ]>");return"NODE_DEND";case 54:this.popState();t.getLogger().debug("Lex: ]");return"NODE_DEND";case 55:t.getLogger().debug("Lexa: -)");this.pushState("NODE");return 36;case 56:t.getLogger().debug("Lexa: (-");this.pushState("NODE");return 36;case 57:t.getLogger().debug("Lexa: ))");this.pushState("NODE");return 36;case 58:t.getLogger().debug("Lexa: )");this.pushState("NODE");return 36;case 59:t.getLogger().debug("Lex: (((");this.pushState("NODE");return 36;case 60:t.getLogger().debug("Lexa: )");this.pushState("NODE");return 36;case 61:t.getLogger().debug("Lexa: )");this.pushState("NODE");return 36;case 62:t.getLogger().debug("Lexa: )");this.pushState("NODE");return 36;case 63:t.getLogger().debug("Lexc: >");this.pushState("NODE");return 36;case 64:t.getLogger().debug("Lexa: ([");this.pushState("NODE");return 36;case 65:t.getLogger().debug("Lexa: )");this.pushState("NODE");return 36;case 66:this.pushState("NODE");return 36;case 67:this.pushState("NODE");return 36;case 68:this.pushState("NODE");return 36;case 69:this.pushState("NODE");return 36;case 70:this.pushState("NODE");return 36;case 71:this.pushState("NODE");return 36;case 72:this.pushState("NODE");return 36;case 73:t.getLogger().debug("Lexa: [");this.pushState("NODE");return 36;case 74:this.pushState("BLOCK_ARROW");t.getLogger().debug("LEX ARR START");return 38;case 75:t.getLogger().debug("Lex: NODE_ID",s.yytext);return 32;case 76:t.getLogger().debug("Lex: EOF",s.yytext);return 8;case 77:this.pushState("md_string");break;case 78:this.pushState("md_string");break;case 79:return"NODE_DESCR";case 80:this.popState();break;case 81:t.getLogger().debug("Lex: Starting string");this.pushState("string");break;case 82:t.getLogger().debug("LEX ARR: Starting string");this.pushState("string");break;case 83:t.getLogger().debug("LEX: NODE_DESCR:",s.yytext);return"NODE_DESCR";case 84:t.getLogger().debug("LEX POPPING");this.popState();break;case 85:t.getLogger().debug("Lex: =>BAE");this.pushState("ARROW_DIR");break;case 86:s.yytext=s.yytext.replace(/^,\s*/,"");t.getLogger().debug("Lex (right): dir:",s.yytext);return"DIR";case 87:s.yytext=s.yytext.replace(/^,\s*/,"");t.getLogger().debug("Lex (left):",s.yytext);return"DIR";case 88:s.yytext=s.yytext.replace(/^,\s*/,"");t.getLogger().debug("Lex (x):",s.yytext);return"DIR";case 89:s.yytext=s.yytext.replace(/^,\s*/,"");t.getLogger().debug("Lex (y):",s.yytext);return"DIR";case 90:s.yytext=s.yytext.replace(/^,\s*/,"");t.getLogger().debug("Lex (up):",s.yytext);return"DIR";case 91:s.yytext=s.yytext.replace(/^,\s*/,"");t.getLogger().debug("Lex (down):",s.yytext);return"DIR";case 92:s.yytext="]>";t.getLogger().debug("Lex (ARROW_DIR end):",s.yytext);this.popState();this.popState();return"BLOCK_ARROW_END";case 93:t.getLogger().debug("Lex: LINK","#"+s.yytext+"#");return 15;case 94:t.getLogger().debug("Lex: LINK",s.yytext);return 15;case 95:t.getLogger().debug("Lex: LINK",s.yytext);return 15;case 96:t.getLogger().debug("Lex: LINK",s.yytext);return 15;case 97:t.getLogger().debug("Lex: START_LINK",s.yytext);this.pushState("LLABEL");return 16;case 98:t.getLogger().debug("Lex: START_LINK",s.yytext);this.pushState("LLABEL");return 16;case 99:t.getLogger().debug("Lex: START_LINK",s.yytext);this.pushState("LLABEL");return 16;case 100:this.pushState("md_string");break;case 101:t.getLogger().debug("Lex: Starting string");this.pushState("string");return"LINK_LABEL";case 102:this.popState();t.getLogger().debug("Lex: LINK","#"+s.yytext+"#");return 15;case 103:this.popState();t.getLogger().debug("Lex: LINK",s.yytext);return 15;case 104:this.popState();t.getLogger().debug("Lex: LINK",s.yytext);return 15;case 105:t.getLogger().debug("Lex: COLON",s.yytext);s.yytext=s.yytext.slice(1);return 27}},rules:[/^(?:block-beta\b)/,/^(?:block\s+)/,/^(?:block\n+)/,/^(?:block:)/,/^(?:[\s]+)/,/^(?:[\n]+)/,/^(?:((\u000D\u000A)|(\u000A)))/,/^(?:columns\s+auto\b)/,/^(?:columns\s+[\d]+)/,/^(?:["][`])/,/^(?:[^`"]+)/,/^(?:[`]["])/,/^(?:["])/,/^(?:["])/,/^(?:[^"]*)/,/^(?:space[:]\d+)/,/^(?:space\b)/,/^(?:default\b)/,/^(?:linkStyle\b)/,/^(?:interpolate\b)/,/^(?:classDef\s+)/,/^(?:DEFAULT\s+)/,/^(?:\w+\s+)/,/^(?:[^\n]*)/,/^(?:class\s+)/,/^(?:(\w+)+((,\s*\w+)*))/,/^(?:[^\n]*)/,/^(?:style\s+)/,/^(?:(\w+)+((,\s*\w+)*))/,/^(?:[^\n]*)/,/^(?:accTitle\s*:\s*)/,/^(?:(?!\n||)*[^\n]*)/,/^(?:accDescr\s*:\s*)/,/^(?:(?!\n||)*[^\n]*)/,/^(?:accDescr\s*\{\s*)/,/^(?:[\}])/,/^(?:[^\}]*)/,/^(?:end\b\s*)/,/^(?:\(\(\()/,/^(?:\)\)\))/,/^(?:[\)]\))/,/^(?:\}\})/,/^(?:\})/,/^(?:\(-)/,/^(?:-\))/,/^(?:\(\()/,/^(?:\]\])/,/^(?:\()/,/^(?:\]\))/,/^(?:\\\])/,/^(?:\/\])/,/^(?:\)\])/,/^(?:[\)])/,/^(?:\]>)/,/^(?:[\]])/,/^(?:-\))/,/^(?:\(-)/,/^(?:\)\))/,/^(?:\))/,/^(?:\(\(\()/,/^(?:\(\()/,/^(?:\{\{)/,/^(?:\{)/,/^(?:>)/,/^(?:\(\[)/,/^(?:\()/,/^(?:\[\[)/,/^(?:\[\|)/,/^(?:\[\()/,/^(?:\)\)\))/,/^(?:\[\\)/,/^(?:\[\/)/,/^(?:\[\\)/,/^(?:\[)/,/^(?:<\[)/,/^(?:[^\(\[\n\-\)\{\}\s\<\>:]+)/,/^(?:$)/,/^(?:["][`])/,/^(?:["][`])/,/^(?:[^`"]+)/,/^(?:[`]["])/,/^(?:["])/,/^(?:["])/,/^(?:[^"]+)/,/^(?:["])/,/^(?:\]>\s*\()/,/^(?:,?\s*right\s*)/,/^(?:,?\s*left\s*)/,/^(?:,?\s*x\s*)/,/^(?:,?\s*y\s*)/,/^(?:,?\s*up\s*)/,/^(?:,?\s*down\s*)/,/^(?:\)\s*)/,/^(?:\s*[xo<]?--+[-xo>]\s*)/,/^(?:\s*[xo<]?==+[=xo>]\s*)/,/^(?:\s*[xo<]?-?\.+-[xo>]?\s*)/,/^(?:\s*~~[\~]+\s*)/,/^(?:\s*[xo<]?--\s*)/,/^(?:\s*[xo<]?==\s*)/,/^(?:\s*[xo<]?-\.\s*)/,/^(?:["][`])/,/^(?:["])/,/^(?:\s*[xo<]?--+[-xo>]\s*)/,/^(?:\s*[xo<]?==+[=xo>]\s*)/,/^(?:\s*[xo<]?-?\.+-[xo>]?\s*)/,/^(?::\d+)/],conditions:{STYLE_DEFINITION:{rules:[29],inclusive:false},STYLE_STMNT:{rules:[28],inclusive:false},CLASSDEFID:{rules:[23],inclusive:false},CLASSDEF:{rules:[21,22],inclusive:false},CLASS_STYLE:{rules:[26],inclusive:false},CLASS:{rules:[25],inclusive:false},LLABEL:{rules:[100,101,102,103,104],inclusive:false},ARROW_DIR:{rules:[86,87,88,89,90,91,92],inclusive:false},BLOCK_ARROW:{rules:[77,82,85],inclusive:false},NODE:{rules:[38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,78,81],inclusive:false},md_string:{rules:[10,11,79,80],inclusive:false},space:{rules:[],inclusive:false},string:{rules:[13,14,83,84],inclusive:false},acc_descr_multiline:{rules:[35,36],inclusive:false},acc_descr:{rules:[33],inclusive:false},acc_title:{rules:[31],inclusive:false},INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,12,15,16,17,18,19,20,24,27,30,32,34,37,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,93,94,95,96,97,98,99,105],inclusive:true}}};return e}();b.lexer=f;function x(){this.yy={}}x.prototype=b;b.Parser=x;return new x}();f.parser=f;const x=f;let L={};let S=[];let _={};const m="color";const k="fill";const E="bgFill";const v=",";const D=(0,i.c)();let w={};const N=e=>i.e.sanitizeText(e,D);const $=function(e,t=""){if(w[e]===void 0){w[e]={id:e,styles:[],textStyles:[]}}const s=w[e];if(t!==void 0&&t!==null){t.split(v).forEach((e=>{const t=e.replace(/([^;]*);/,"$1").trim();if(e.match(m)){const e=t.replace(k,E);const i=e.replace(m,k);s.textStyles.push(i)}s.styles.push(t)}))}};const I=function(e,t=""){const s=L[e];if(t!==void 0&&t!==null){s.styles=t.split(v)}};const T=function(e,t){e.split(",").forEach((function(e){let s=L[e];if(s===void 0){const t=e.trim();L[t]={id:t,type:"na",children:[]};s=L[t]}if(!s.classes){s.classes=[]}s.classes.push(t)}))};const O=(e,t)=>{const s=e.flat();const i=[];for(const r of s){if(r.label){r.label=N(r.label)}if(r.type==="classDef"){$(r.id,r.css);continue}if(r.type==="applyClass"){T(r.id,(r==null?void 0:r.styleClass)||"");continue}if(r.type==="applyStyles"){if(r==null?void 0:r.stylesStr){I(r.id,r==null?void 0:r.stylesStr)}continue}if(r.type==="column-setting"){t.columns=r.columns||-1}else if(r.type==="edge"){if(_[r.id]){_[r.id]++}else{_[r.id]=1}r.id=_[r.id]+"-"+r.id;S.push(r)}else{if(!r.label){if(r.type==="composite"){r.label=""}else{r.label=r.id}}const e=!L[r.id];if(e){L[r.id]=r}else{if(r.type!=="na"){L[r.id].type=r.type}if(r.label!==r.id){L[r.id].label=r.label}}if(r.children){O(r.children,r)}if(r.type==="space"){const e=r.width||1;for(let t=0;t<e;t++){const e=(0,n.A)(r);e.id=e.id+"-"+t;L[e.id]=e;i.push(e)}}else if(e){i.push(r)}}}t.children=i};let A=[];let z={id:"root",type:"composite",children:[],columns:-1};const C=()=>{i.l.debug("Clear called");(0,i.v)();z={id:"root",type:"composite",children:[],columns:-1};L={root:z};A=[];w={};S=[];_={}};function R(e){i.l.debug("typeStr2Type",e);switch(e){case"[]":return"square";case"()":i.l.debug("we have a round");return"round";case"(())":return"circle";case">]":return"rect_left_inv_arrow";case"{}":return"diamond";case"{{}}":return"hexagon";case"([])":return"stadium";case"[[]]":return"subroutine";case"[()]":return"cylinder";case"((()))":return"doublecircle";case"[//]":return"lean_right";case"[\\\\]":return"lean_left";case"[/\\]":return"trapezoid";case"[\\/]":return"inv_trapezoid";case"<[]>":return"block_arrow";default:return"na"}}function B(e){i.l.debug("typeStr2Type",e);switch(e){case"==":return"thick";default:return"normal"}}function F(e){switch(e.trim()){case"--x":return"arrow_cross";case"--o":return"arrow_circle";default:return"arrow_point"}}let P=0;const Y=()=>{P++;return"id-"+Math.random().toString(36).substr(2,12)+"-"+P};const K=e=>{z.children=e;O(e,z);A=z.children};const X=e=>{const t=L[e];if(!t){return-1}if(t.columns){return t.columns}if(!t.children){return-1}return t.children.length};const M=()=>[...Object.values(L)];const W=()=>A||[];const U=()=>S;const j=e=>L[e];const H=e=>{L[e.id]=e};const G=()=>console;const q=function(){return w};const Z={getConfig:()=>(0,i.F)().block,typeStr2Type:R,edgeTypeStr2Type:B,edgeStrToEdgeData:F,getLogger:G,getBlocksFlat:M,getBlocks:W,getEdges:U,setHierarchy:K,getBlock:j,setBlock:H,getColumns:X,getClasses:q,clear:C,generateId:Y};const J=Z;const Q=(e,t)=>{const s=r.A;const i=s(e,"r");const n=s(e,"g");const l=s(e,"b");return o.A(i,n,l,t)};const V=e=>`.label {\n    font-family: ${e.fontFamily};\n    color: ${e.nodeTextColor||e.textColor};\n  }\n  .cluster-label text {\n    fill: ${e.titleColor};\n  }\n  .cluster-label span,p {\n    color: ${e.titleColor};\n  }\n\n\n\n  .label text,span,p {\n    fill: ${e.nodeTextColor||e.textColor};\n    color: ${e.nodeTextColor||e.textColor};\n  }\n\n  .node rect,\n  .node circle,\n  .node ellipse,\n  .node polygon,\n  .node path {\n    fill: ${e.mainBkg};\n    stroke: ${e.nodeBorder};\n    stroke-width: 1px;\n  }\n  .flowchart-label text {\n    text-anchor: middle;\n  }\n  // .flowchart-label .text-outer-tspan {\n  //   text-anchor: middle;\n  // }\n  // .flowchart-label .text-inner-tspan {\n  //   text-anchor: start;\n  // }\n\n  .node .label {\n    text-align: center;\n  }\n  .node.clickable {\n    cursor: pointer;\n  }\n\n  .arrowheadPath {\n    fill: ${e.arrowheadColor};\n  }\n\n  .edgePath .path {\n    stroke: ${e.lineColor};\n    stroke-width: 2.0px;\n  }\n\n  .flowchart-link {\n    stroke: ${e.lineColor};\n    fill: none;\n  }\n\n  .edgeLabel {\n    background-color: ${e.edgeLabelBackground};\n    rect {\n      opacity: 0.5;\n      background-color: ${e.edgeLabelBackground};\n      fill: ${e.edgeLabelBackground};\n    }\n    text-align: center;\n  }\n\n  /* For html labels only */\n  .labelBkg {\n    background-color: ${Q(e.edgeLabelBackground,.5)};\n    // background-color:\n  }\n\n  .node .cluster {\n    // fill: ${Q(e.mainBkg,.5)};\n    fill: ${Q(e.clusterBkg,.5)};\n    stroke: ${Q(e.clusterBorder,.2)};\n    box-shadow: rgba(50, 50, 93, 0.25) 0px 13px 27px -5px, rgba(0, 0, 0, 0.3) 0px 8px 16px -8px;\n    stroke-width: 1px;\n  }\n\n  .cluster text {\n    fill: ${e.titleColor};\n  }\n\n  .cluster span,p {\n    color: ${e.titleColor};\n  }\n  /* .cluster div {\n    color: ${e.titleColor};\n  } */\n\n  div.mermaidTooltip {\n    position: absolute;\n    text-align: center;\n    max-width: 200px;\n    padding: 2px;\n    font-family: ${e.fontFamily};\n    font-size: 12px;\n    background: ${e.tertiaryColor};\n    border: 1px solid ${e.border2};\n    border-radius: 2px;\n    pointer-events: none;\n    z-index: 100;\n  }\n\n  .flowchartTitleText {\n    text-anchor: middle;\n    font-size: 18px;\n    fill: ${e.textColor};\n  }\n`;const ee=V;function te(e,t,s=false){var n,r,o;const l=e;let a="default";if((((n=l==null?void 0:l.classes)==null?void 0:n.length)||0)>0){a=((l==null?void 0:l.classes)||[]).join(" ")}a=a+" flowchart-label";let c=0;let u="";let h;switch(l.type){case"round":c=5;u="rect";break;case"composite":c=0;u="composite";h=0;break;case"square":u="rect";break;case"diamond":u="question";break;case"hexagon":u="hexagon";break;case"block_arrow":u="block_arrow";break;case"odd":u="rect_left_inv_arrow";break;case"lean_right":u="lean_right";break;case"lean_left":u="lean_left";break;case"trapezoid":u="trapezoid";break;case"inv_trapezoid":u="inv_trapezoid";break;case"rect_left_inv_arrow":u="rect_left_inv_arrow";break;case"circle":u="circle";break;case"ellipse":u="ellipse";break;case"stadium":u="stadium";break;case"subroutine":u="subroutine";break;case"cylinder":u="cylinder";break;case"group":u="rect";break;case"doublecircle":u="doublecircle";break;default:u="rect"}const d=(0,i.k)((l==null?void 0:l.styles)||[]);const g=l.label;const y=l.size||{width:0,height:0,x:0,y:0};const p={labelStyle:d.labelStyle,shape:u,labelText:g,rx:c,ry:c,class:a,style:d.style,id:l.id,directions:l.directions,width:y.width,height:y.height,x:y.x,y:y.y,positioned:s,intersect:void 0,type:l.type,padding:h??(((o=(r=(0,i.F)())==null?void 0:r.block)==null?void 0:o.padding)||0)};return p}async function se(e,t,s){const i=te(t,s,false);if(i.type==="group"){return}const n=await(0,l.e)(e,i);const r=n.node().getBBox();const o=s.getBlock(i.id);o.size={width:r.width,height:r.height,x:0,y:0,node:n};s.setBlock(o);n.remove()}async function ie(e,t,s){const i=te(t,s,true);const n=s.getBlock(i.id);if(n.type!=="space"){await(0,l.e)(e,i);t.intersect=i==null?void 0:i.intersect;(0,l.p)(i)}}async function ne(e,t,s,i){for(const n of t){await i(e,n,s);if(n.children){await ne(e,n.children,s,i)}}}async function re(e,t,s){await ne(e,t,s,se)}async function oe(e,t,s){await ne(e,t,s,ie)}async function le(e,t,s,i,n){const r=new a.T({multigraph:true,compound:true});r.setGraph({rankdir:"TB",nodesep:10,ranksep:10,marginx:8,marginy:8});for(const o of s){if(o.size){r.setNode(o.id,{width:o.size.width,height:o.size.height,intersect:o.intersect})}}for(const o of t){if(o.start&&o.end){const t=i.getBlock(o.start);const s=i.getBlock(o.end);if((t==null?void 0:t.size)&&(s==null?void 0:s.size)){const i=t.size;const a=s.size;const c=[{x:i.x,y:i.y},{x:i.x+(a.x-i.x)/2,y:i.y+(a.y-i.y)/2},{x:a.x,y:a.y}];await(0,l.h)(e,{v:o.start,w:o.end,name:o.id},{...o,arrowTypeEnd:o.arrowTypeEnd,arrowTypeStart:o.arrowTypeStart,points:c,classes:"edge-thickness-normal edge-pattern-solid flowchart-link LS-a1 LE-b1"},void 0,"block",r,n);if(o.label){await(0,l.f)(e,{...o,label:o.label,labelStyle:"stroke: #333; stroke-width: 1.5px;fill:none;",arrowTypeEnd:o.arrowTypeEnd,arrowTypeStart:o.arrowTypeStart,points:c,classes:"edge-thickness-normal edge-pattern-solid flowchart-link LS-a1 LE-b1"});await(0,l.j)({...o,x:c[1].x,y:c[1].y},{originalPath:c})}}}}}const ae=((b=(p=(0,i.c)())==null?void 0:p.block)==null?void 0:b.padding)||8;function ce(e,t){if(e===0||!Number.isInteger(e)){throw new Error("Columns must be an integer !== 0.")}if(t<0||!Number.isInteger(t)){throw new Error("Position must be a non-negative integer."+t)}if(e<0){return{px:t,py:0}}if(e===1){return{px:0,py:t}}const s=t%e;const i=Math.floor(t/e);return{px:s,py:i}}const ue=e=>{let t=0;let s=0;for(const n of e.children){const{width:r,height:o,x:l,y:a}=n.size||{width:0,height:0,x:0,y:0};i.l.debug("getMaxChildSize abc95 child:",n.id,"width:",r,"height:",o,"x:",l,"y:",a,n.type);if(n.type==="space"){continue}if(r>t){t=r/(e.widthInColumns||1)}if(o>s){s=o}}return{width:t,height:s}};function he(e,t,s=0,n=0){var r,o,l,a,c,u,h,d,g,y,p;i.l.debug("setBlockSizes abc95 (start)",e.id,(r=e==null?void 0:e.size)==null?void 0:r.x,"block width =",e==null?void 0:e.size,"sieblingWidth",s);if(!((o=e==null?void 0:e.size)==null?void 0:o.width)){e.size={width:s,height:n,x:0,y:0}}let b=0;let f=0;if(((l=e.children)==null?void 0:l.length)>0){for(const s of e.children){he(s,t)}const r=ue(e);b=r.width;f=r.height;i.l.debug("setBlockSizes abc95 maxWidth of",e.id,":s children is ",b,f);for(const t of e.children){if(t.size){i.l.debug(`abc95 Setting size of children of ${e.id} id=${t.id} ${b} ${f} ${t.size}`);t.size.width=b*(t.widthInColumns||1)+ae*((t.widthInColumns||1)-1);t.size.height=f;t.size.x=0;t.size.y=0;i.l.debug(`abc95 updating size of ${e.id} children child:${t.id} maxWidth:${b} maxHeight:${f}`)}}for(const s of e.children){he(s,t,b,f)}const o=e.columns||-1;let l=0;for(const t of e.children){l+=t.widthInColumns||1}let d=e.children.length;if(o>0&&o<l){d=o}e.widthInColumns||1;const g=Math.ceil(l/d);let y=d*(b+ae)+ae;let p=g*(f+ae)+ae;if(y<s){i.l.debug(`Detected to small siebling: abc95 ${e.id} sieblingWidth ${s} sieblingHeight ${n} width ${y}`);y=s;p=n;const t=(s-d*ae-ae)/d;const r=(n-g*ae-ae)/g;i.l.debug("Size indata abc88",e.id,"childWidth",t,"maxWidth",b);i.l.debug("Size indata abc88",e.id,"childHeight",r,"maxHeight",f);i.l.debug("Size indata abc88 xSize",d,"padding",ae);for(const s of e.children){if(s.size){s.size.width=t;s.size.height=r;s.size.x=0;s.size.y=0}}}i.l.debug(`abc95 (finale calc) ${e.id} xSize ${d} ySize ${g} columns ${o}${e.children.length} width=${Math.max(y,((a=e.size)==null?void 0:a.width)||0)}`);if(y<(((c=e==null?void 0:e.size)==null?void 0:c.width)||0)){y=((u=e==null?void 0:e.size)==null?void 0:u.width)||0;const t=o>0?Math.min(e.children.length,o):e.children.length;if(t>0){const s=(y-t*ae-ae)/t;i.l.debug("abc95 (growing to fit) width",e.id,y,(h=e.size)==null?void 0:h.width,s);for(const t of e.children){if(t.size){t.size.width=s}}}}e.size={width:y,height:p,x:0,y:0}}i.l.debug("setBlockSizes abc94 (done)",e.id,(d=e==null?void 0:e.size)==null?void 0:d.x,(g=e==null?void 0:e.size)==null?void 0:g.width,(y=e==null?void 0:e.size)==null?void 0:y.y,(p=e==null?void 0:e.size)==null?void 0:p.height)}function de(e,t){var s,n,r,o,l,a,c,u,h,d,g,y,p,b,f,x,L;i.l.debug(`abc85 layout blocks (=>layoutBlocks) ${e.id} x: ${(s=e==null?void 0:e.size)==null?void 0:s.x} y: ${(n=e==null?void 0:e.size)==null?void 0:n.y} width: ${(r=e==null?void 0:e.size)==null?void 0:r.width}`);const S=e.columns||-1;i.l.debug("layoutBlocks columns abc95",e.id,"=>",S,e);if(e.children&&e.children.length>0){const t=((l=(o=e==null?void 0:e.children[0])==null?void 0:o.size)==null?void 0:l.width)||0;const s=e.children.length*t+(e.children.length-1)*ae;i.l.debug("widthOfChildren 88",s,"posX");let n=0;i.l.debug("abc91 block?.size?.x",e.id,(a=e==null?void 0:e.size)==null?void 0:a.x);let r=((c=e==null?void 0:e.size)==null?void 0:c.x)?((u=e==null?void 0:e.size)==null?void 0:u.x)+(-((h=e==null?void 0:e.size)==null?void 0:h.width)/2||0):-ae;let f=0;for(const o of e.children){const t=e;if(!o.size){continue}const{width:s,height:l}=o.size;const{px:a,py:c}=ce(S,n);if(c!=f){f=c;r=((d=e==null?void 0:e.size)==null?void 0:d.x)?((g=e==null?void 0:e.size)==null?void 0:g.x)+(-((y=e==null?void 0:e.size)==null?void 0:y.width)/2||0):-ae;i.l.debug("New row in layout for block",e.id," and child ",o.id,f)}i.l.debug(`abc89 layout blocks (child) id: ${o.id} Pos: ${n} (px, py) ${a},${c} (${(p=t==null?void 0:t.size)==null?void 0:p.x},${(b=t==null?void 0:t.size)==null?void 0:b.y}) parent: ${t.id} width: ${s}${ae}`);if(t.size){const e=s/2;o.size.x=r+ae+e;i.l.debug(`abc91 layout blocks (calc) px, pyid:${o.id} startingPos=X${r} new startingPosX${o.size.x} ${e} padding=${ae} width=${s} halfWidth=${e} => x:${o.size.x} y:${o.size.y} ${o.widthInColumns} (width * (child?.w || 1)) / 2 ${s*((o==null?void 0:o.widthInColumns)||1)/2}`);r=o.size.x+e;o.size.y=t.size.y-t.size.height/2+c*(l+ae)+l/2+ae;i.l.debug(`abc88 layout blocks (calc) px, pyid:${o.id}startingPosX${r}${ae}${e}=>x:${o.size.x}y:${o.size.y}${o.widthInColumns}(width * (child?.w || 1)) / 2${s*((o==null?void 0:o.widthInColumns)||1)/2}`)}if(o.children){de(o)}n+=(o==null?void 0:o.widthInColumns)||1;i.l.debug("abc88 columnsPos",o,n)}}i.l.debug(`layout blocks (<==layoutBlocks) ${e.id} x: ${(f=e==null?void 0:e.size)==null?void 0:f.x} y: ${(x=e==null?void 0:e.size)==null?void 0:x.y} width: ${(L=e==null?void 0:e.size)==null?void 0:L.width}`)}function ge(e,{minX:t,minY:s,maxX:i,maxY:n}={minX:0,minY:0,maxX:0,maxY:0}){if(e.size&&e.id!=="root"){const{x:r,y:o,width:l,height:a}=e.size;if(r-l/2<t){t=r-l/2}if(o-a/2<s){s=o-a/2}if(r+l/2>i){i=r+l/2}if(o+a/2>n){n=o+a/2}}if(e.children){for(const r of e.children){({minX:t,minY:s,maxX:i,maxY:n}=ge(r,{minX:t,minY:s,maxX:i,maxY:n}))}}return{minX:t,minY:s,maxX:i,maxY:n}}function ye(e){const t=e.getBlock("root");if(!t){return}he(t,e,0,0);de(t);i.l.debug("getBlocks",JSON.stringify(t,null,2));const{minX:s,minY:n,maxX:r,maxY:o}=ge(t);const l=o-n;const a=r-s;return{x:s,y:n,width:a,height:l}}const pe=function(e,t){return t.db.getClasses()};const be=async function(e,t,s,n){const{securityLevel:r,block:o}=(0,i.F)();const a=n.db;let u;if(r==="sandbox"){u=(0,c.Ltv)("#i"+t)}const h=r==="sandbox"?(0,c.Ltv)(u.nodes()[0].contentDocument.body):(0,c.Ltv)("body");const d=r==="sandbox"?h.select(`[id="${t}"]`):(0,c.Ltv)(`[id="${t}"]`);const g=["point","circle","cross"];(0,l.a)(d,g,n.type,t);const y=a.getBlocks();const p=a.getBlocksFlat();const b=a.getEdges();const f=d.insert("g").attr("class","block");await re(f,y,a);const x=ye(a);await oe(f,y,a);await le(f,b,p,a,t);if(x){const e=x;const t=Math.max(1,Math.round(.125*(e.width/e.height)));const s=e.height+t+10;const n=e.width+10;const{useMaxWidth:r}=o;(0,i.i)(d,s,n,!!r);i.l.debug("Here Bounds",x,e);d.attr("viewBox",`${e.x-5} ${e.y-5} ${e.width+10} ${e.height+10}`)}(0,c.UMr)(c.zt)};const fe={draw:be,getClasses:pe};const xe={parser:x,db:J,renderer:fe,styles:ee}}}]);
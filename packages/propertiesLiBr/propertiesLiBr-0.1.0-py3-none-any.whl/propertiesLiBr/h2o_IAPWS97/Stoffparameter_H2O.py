#  This M-file contains the coefficients for calculating the thermodynamical properties 
#  of water and steam according to the release of the IAPWS industrial formulation 1997
#
#  This routine has been adapted from:
#  water97_v12: A collection of Visual Basic defs
#  for calculating properties of water and steam.
#
#  Source: IAPWS-IF97. For details see
#  http://chemengineer.about.com/library/weekly/aa071700a.htm
#  http://chemengineer.about.com/library/weekly/aa073100a.htm
#  http://chemengineer.about.com/library/weekly/aa081400a.htm
#
#
#  Version 1.2, 02/06/01:   starting value for iteration in densreg3 for
#                           supercritical temperatures changed from 500 to 600
#
#
#  Version 1.1, 01/29/01:   mistake in calculation of partial derivatives
#                           for thermal conductivity corrected
#
#  [c] B. Spang, About Guide to Chemical Engineering, Hamburg, 2000, 2001
#      E-Mail: chemengineer.guide@about.com
#
#  The original coefficients have been developed as an ADD-IN for Microsoft Excel.
#  The routines for saturated Water/Lithiumbromid solution have been added by
#  S. Petersen and J. Albers, IEMB, Salzufer 14, 10587 Berlin, Germany albers@iemb.de
#  according to Feuerecker ....
#
#  For the use with MATLAB it was neccesary to change some indizes which starts with zero
#  in the IAPWS formulation. They are now starting with one.
#
rgas_water = 461.526
tc_water = 647.096

# AddIn sub InitFieldsreg1[]
ireg1 = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 8, 8, 21, 23, 29, 30, 31, 32]

jreg1 = [-2, -1, 0, 1, 2, 3, 4, 5, -9, -7, -1, 0, 1, 3, -3, 0, 1, 3, 17, -4, 0, 6, -5, -2, 10, -8, -11, -6, -29, -31,
         -38, -39, -40, -41]

nreg1 = [0.14632971213167, -0.84548187169114, -3.756360367204, 3.3855169168385, -0.95791963387872, 0.15772038513228,
         -0.016616417199501, 8.1214629983568E-04, 2.8319080123804E-04, -6.0706301565874E-04, -0.018990068218419,
         -0.032529748770505, -0.021841717175414, -5.283835796993E-05, -4.7184321073267E-04, -3.0001780793026E-04,
         4.7661393906987E-05, -4.4141845330846E-06, -7.2694996297594E-16, -3.1679644845054E-05, -2.8270797985312E-06,
         -8.5205128120103E-10, -2.2425281908E-06, -6.5171222895601E-07, -1.4341729937924E-13, -4.0516996860117E-07,
         -1.2734301741641E-09, -1.7424871230634E-10, -6.8762131295531E-19, 1.4478307828521E-20, 2.6335781662795E-23,
         -1.1947622640071E-23, 1.8228094581404E-24, -9.3537087292458E-26]

# AddIn InitFieldsreg2[]
j0reg2 = [0, 1, -5, -4, -3, -2, -1, 2, 3]

n0reg2 = [-9.6927686500217, 10.086655968018, -0.005608791128302, 0.071452738081455, -0.40710498223928, 1.4240819171444,
          -4.383951131945, -0.28408632460772, 0.021268463753307]

ireg2 = [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 5, 6, 6, 6, 7, 7, 7, 8, 8, 9, 10, 10, 10, 16, 16, 18, 20,
         20, 20, 21, 22, 23, 24, 24, 24]

jreg2 = [0, 1, 2, 3, 6, 1, 2, 4, 7, 36, 0, 1, 3, 6, 35, 1, 2, 3, 7, 3, 16, 35, 0, 11, 25, 8, 36, 13, 4, 10, 14, 29, 50,
         57, 20, 35, 48, 21, 53, 39, 26, 40, 58]

nreg2 = [-1.7731742473213E-03, -0.017834862292358, -0.045996013696365, -0.057581259083432, -0.05032527872793,
         -3.3032641670203E-05, -1.8948987516315E-04, -3.9392777243355E-03, -0.043797295650573, -2.6674547914087E-05,
         2.0481737692309E-08, 4.3870667284435E-07, -3.227767723857E-05, -1.5033924542148E-03, -0.040668253562649,
         -7.8847309559367E-10, 1.2790717852285E-08, 4.8225372718507E-07, 2.2922076337661E-06, -1.6714766451061E-11,
         -2.1171472321355E-03, -23.895741934104, -5.905956432427E-18, -1.2621808899101E-06, -0.038946842435739,
         1.1256211360459E-11, -8.2311340897998, 1.9809712802088E-08, 1.0406965210174E-19, -1.0234747095929E-13,
         -1.0018179379511E-09, -8.0882908646985E-11, 0.10693031879409, -0.33662250574171, 8.9185845355421E-25,
         3.0629316876232E-13, -4.2002467698208E-06, -5.9056029685639E-26, 3.7826947613457E-06, -1.2768608934681E-15,
         7.3087610595061E-29, 5.5414715350778E-17, -9.436970724121E-07]

# AddIn InitFieldsreg3[]
ireg3 = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 8, 9, 9,
         10, 10, 11]

jreg3 = [0, 0, 1, 2, 7, 10, 12, 23, 2, 6, 15, 17, 0, 2, 6, 7, 22, 26, 0, 2, 4, 16, 26, 0, 2, 4, 26, 1, 3, 26, 0, 2, 26,
         2, 26, 2, 26, 0, 1, 26]

nreg3 = [1.0658070028513, -15.732845290239, 20.944396974307, -7.6867707878716, 2.6185947787954, -2.808078114862,
         1.2053369696517, -8.4566812812502E-03, -1.2654315477714, -1.1524407806681, 0.88521043984318, -0.64207765181607,
         0.38493460186671, -0.85214708824206, 4.8972281541877, -3.0502617256965, 0.039420536879154, 0.12558408424308,
         -0.2799932969871, 1.389979956946, -2.018991502357, -8.2147637173963E-03, -0.47596035734923, 0.0439840744735,
         -0.44476435428739, 0.90572070719733, 0.70522450087967, 0.10770512626332, -0.32913623258954, -0.50871062041158,
         -0.022175400873096, 0.094260751665092, 0.16436278447961, -0.013503372241348, -0.014834345352472,
         5.7922953628084E-04, 3.2308904703711E-03, 8.0964802996215E-05, -1.6557679795037E-04, -4.4923899061815E-05]

# AddIn InitFieldsreg4[]
nreg4 = [1167.0521452767, -724213.16703206, -17.073846940092, 12020.82470247, -3232555.0322333, 14.91510861353,
         -4823.2657361591, 405113.40542057, -0.23855557567849, 650.17534844798]

# AddIn Sub InitFieldsbound[]

nbound = [348.05185628969, -1.1671859879975, 1.0192970039326E-03, 572.54459862746, 13.91883977887]
# AddIn Sub InitFieldsvisc[]

n0visc = [1, 0.978197, 0.579829, -0.202354]

ivisc = [0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3, 3, 4, 4, 5, 6]

jvisc = [0, 1, 4, 5, 0, 1, 2, 3, 0, 1, 2, 0, 1, 2, 3, 0, 3, 1, 3]

nvisc = [0.5132047, 0.3205656, -0.7782567, 0.1885447, 0.2151778, 0.7317883, 1.241044, 1.476783, -0.2818107, -1.070786,
         -1.263184, 0.1778064, 0.460504, 0.2340379, -0.4924179, -0.0417661, 0.1600435, -0.01578386, -0.003629481]

# AddIn Sub InitFieldsthcon[]

n0thcon = [1, 6.978267, 2.599096, -0.998254]

nthcon = [[1.3293046, -0.40452437, 0.2440949, 0.018660751, -0.12961068, 0.044809953],
          [1.7018363, -2.2156845, 1.6511057, -0.76736002, 0.37283344, -0.1120316],
          [5.2246158, -10.124111, 4.9874687, -0.27297694, -0.43083393, 0.13333849],
          [8.7127675, -9.5000611, 4.3786606, -0.91783782, 0, 0],
          [-1.8525999, 0.9340469, 0, 0, 0, 0]]

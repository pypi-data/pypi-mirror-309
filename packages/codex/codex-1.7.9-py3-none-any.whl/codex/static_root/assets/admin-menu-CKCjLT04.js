import{_,h as S,j as s,k as a,q as C,D as i,a as r,w as d,l as p,F as h,v as F,n as k,x as m,ad as L,A as f,E as v,a2 as J,L as g,bz as M,G as B,H as x,cH as A,bx as y,$ as O}from"./main-B0XsokNO.js";import{C as R}from"./change-password-dialog-DWFtOUJt.js";import{useAdminStore as I}from"./admin-DSf9mKpY.js";import{d as D}from"./VSelectionControl-dirzqbsX.js";import{a as T}from"./VDivider-Nn4Fa5-R.js";import{n as U}from"./forwardRefs--sLajfbv.js";import{v as w,a as P,C as V}from"./VDialog-Z7zDn7KN.js";import{T as N}from"./index-CJNrYOQJ.js";import"./VForm-CVsL2Cxt.js";const E="Create Covers",Q="Remove Covers",z="Find Orphan Covers",G="Adopt Orphan Folders",W="Create Custom Covers",H="Delete Custom Covers",X="Link Custom Covers",j="Custom Covers Moved",q="Discover Missing Custom Covers",K="Modify Custom Covers",Y="Remove Folders",Z="Move Folders",$="Modify Folders",ee="Create Books",te="Remove Books",oe="Record Failed Imports",se="Move Books",ne="Modify Books",ae="Update First Covers",re="Link Books to Tags",ie="Prepare Tags for Linking",le="Create Missing Tags",ce="Discover Missing Tags",de="Read Book Tags",me="Cleanup Orphan Bookmarks",Ce="Cleanup Custom Covers",Ie="Restart Codex",ue="Stop Codex",pe="Update Codex Software",ke="Backup Database",Se="Optimize Database",he="Search Index Integrity Check",De="Search Index Repair",_e="Database Integrity Check",fe="Database Foreign Key Check",ve="Check Codex Latest Version",Te="Cleanup Expired Sessions",be="Cleanup Stale Tags",Fe="Search Index Create",Le="Search Index Remove Stale Records",Je="Search Index Optimize",ge="Search Index Update",Me="Search Index Clear",Be="Poll Library",xe={CCC:E,CCD:Q,CFO:z,IAF:G,ICC:W,ICD:H,ICL:X,ICM:j,ICQ:q,ICU:K,IDD:Y,IDM:Z,IDU:$,IFC:ee,IFD:te,IFI:oe,IFM:se,IFU:ne,IGU:ae,IMC:re,IMQ:ie,ITC:le,ITQ:ce,ITR:de,JCB:me,JCD:Ce,JCR:Ie,JCS:ue,JCU:pe,JDB:ke,JDO:Se,JFC:he,JFR:De,JIC:_e,JIF:fe,JLV:ve,JSD:Te,JTD:be,SIC:Fe,SID:Le,SIO:Je,SIU:ge,SIX:Me,WPO:Be},Ae={name:"AdminStatusList",components:{CloseButton:R},data(){return{mdiCloseCircleOutline:J}},computed:{...v(I,{librarianStatuses:e=>e.librarianStatuses,show:e=>e.librarianStatuses.length>0})},created(){this.load()},methods:{...f(I,["loadTable","librarianTask"]),showComplete:e=>Number.isInteger(e.complete),indeterminate:e=>e.active&&(!e.total||!Number.isInteger(e.complete)),progress(e){return!e.total||globalThis.indeterminate?0:100*+e.complete/+e.total},load(){this.loadTable("LibrarianStatus")},clear(){this.librarianTask("librarian_clear_status","")},title(e){return xe[e.statusType]},nf(e){return Number.isInteger(e)?L.format(e):"?"}}},ye={key:0},Oe={nav:"",class:"statusItem"},Re={class:"statusItemTitle"},Ue={key:0,class:"statusItemSubtitle"},we={key:1,class:"statusItemSubtitle"},Pe={key:0};function Ve(e,n,l,b,u,t){const c=S("CloseButton");return s(),a(h,null,[e.show?(s(),C(T,{key:0})):i("",!0),r(P,{onClick:t.load},{default:d(()=>[r(D,null,{default:d(()=>[e.show?(s(),a("div",ye,[r(c,{id:"clearButton",title:"Clear Librarian Statuses",size:"small",onClick:t.clear},null,8,["onClick"]),n[0]||(n[0]=p("h4",null,"Librarian Tasks",-1)),(s(!0),a(h,null,F(e.librarianStatuses,o=>(s(),C(D,{key:o.statusType},{default:d(()=>[p("div",Oe,[p("div",Re,[k(m(t.title(o))+" ",1),o.subtitle?(s(),a("div",Ue,m(o.subtitle),1)):i("",!0),t.showComplete(o)||Number.isInteger(o.total)?(s(),a("div",we,[t.showComplete(o)?(s(),a("span",Pe,m(t.nf(o.complete))+" / ",1)):i("",!0),k(" "+m(t.nf(o.total)),1)])):i("",!0)]),r(U,{indeterminate:t.indeterminate(o),"model-value":t.progress(o),bottom:""},null,8,["indeterminate","model-value"])])]),_:2},1024))),128))])):(s(),C(w,{key:1,id:"noTasksRunning"},{default:d(()=>n[1]||(n[1]=[k(" No librarian tasks running ")])),_:1}))]),_:1})]),_:1},8,["onClick"])],64)}const Ne=_(Ae,[["render",Ve],["__scopeId","data-v-daacefdf"]]),Ee={name:"AdminMenu",components:{AdminStatusList:Ne,CodexListItem:V},data(){return{mdiOpenInNew:O,mdiDatabaseClockOutline:y,mdiCrownOutline:A}},computed:{...B(x,["isUserAdmin"]),...v(I,["unseenFailedImports"]),failedImportsIcon(){return this.unseenFailedImports?M:void 0},showAdminPanelLink(){var e,n,l;return!((l=(n=(e=this.$router.currentRoute)==null?void 0:e.value)==null?void 0:n.name)!=null&&l.startsWith("admin"))}},methods:{...f(I,["clearFailedImports","librarianTask"]),onPoll(){this.librarianTask("poll")}}},Qe={key:0};function ze(e,n,l,b,u,t){const c=S("CodexListItem"),o=S("AdminStatusList");return e.isUserAdmin?(s(),a("div",Qe,[r(T),g(r(c,{title:"Poll All Libraries","prepend-icon":u.mdiDatabaseClockOutline,onClick:t.onPoll},null,8,["prepend-icon","onClick"]),[[N,{openDelay:2e3,text:"for updated comics"}]]),t.showAdminPanelLink?(s(),C(c,{key:0,class:"adminPanelLink",to:{name:"admin"},"prepend-icon":u.mdiCrownOutline,title:"Admin Panel","append-icon":t.failedImportsIcon},null,8,["prepend-icon","append-icon"])):i("",!0),r(o)])):i("",!0)}const $e=_(Ee,[["render",ze]]);export{$e as default};

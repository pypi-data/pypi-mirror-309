{
  "initial_node": "start",
  "nodes": {
    "start": {
      "messages": [
        {
          "role": "system",
          "content": "You are an order-taking assistant. You must ALWAYS use one of the available functions to progress the conversation. For this step, ask the user if they want pizza or sushi, and wait for them to use a function to choose."
        }
      ],
      "functions": [
        {
          "type": "function",
          "function": {
            "name": "choose_pizza",
            "description": "User wants to order pizza",
            "parameters": {
              "type": "object",
              "properties": {}
            }
          }
        },
        {
          "type": "function",
          "function": {
            "name": "choose_sushi",
            "description": "User wants to order sushi",
            "parameters": {
              "type": "object",
              "properties": {}
            }
          }
        }
      ]
    },
    "choose_pizza": {
      "messages": [
        {
          "role": "system",
          "content": "You are handling a pizza order. Use the available functions:- Use select_pizza_size when the user specifies a size (can be used multiple times if they change their mind)- Use the end function ONLY when the user confirms they are done with their orderAfter each size selection, confirm the selection and ask if they want to change it or complete their order.Only use the end function after the user confirms they are satisfied with their order."
        }
      ],
      "functions": [
        {
          "type": "function",
          "function": {
            "name": "end",
            "description": "Complete the order (use only after user confirms)",
            "parameters": {
              "type": "object",
              "properties": {}
            }
          }
        },
        {
          "type": "function",
          "function": {
            "name": "select_pizza_size",
            "description": "Record the selected pizza size",
            "parameters": {
              "type": "object",
              "properties": {
                "size": {
                  "type": "string",
                  "enum": ["small", "medium", "large"],
                  "description": "Size of the pizza"
                }
              },
              "required": ["size"]
            }
          }
        }
      ],
      "pre_actions": [
        {
          "type": "tts_say",
          "text": "Ok, let me help you with your pizza order..."
        }
      ]
    },
    "end": {
      "messages": [
        {
          "role": "system",
          "content": "The order is complete. Thank the user and end the conversation."
        }
      ],
      "functions": [],
      "pre_actions": [
        {
          "type": "tts_say",
          "text": "Thank you for your order! Goodbye!"
        }
      ],
      "post_actions": [
        {
          "type": "end_conversation"
        }
      ]
    },
    "choose_sushi": {
      "messages": [
        {
          "role": "system",
          "content": "You are handling a sushi order. Use the available functions:- Use select_roll_count when the user specifies how many rolls (can be used multiple times if they change their mind)- Use the end function ONLY when the user confirms they are done with their orderAfter each roll count selection, confirm the count and ask if they want to change it or complete their order.Only use the end function after the user confirms they are satisfied with their order."
        }
      ],
      "functions": [
        {
          "type": "function",
          "function": {
            "name": "end",
            "description": "Complete the order (use only after user confirms)",
            "parameters": {
              "type": "object",
              "properties": {}
            }
          }
        },
        {
          "type": "function",
          "function": {
            "name": "select_roll_count",
            "description": "Record the number of sushi rolls",
            "parameters": {
              "type": "object",
              "properties": {
                "count": {
                  "type": "integer",
                  "minimum": 1,
                  "maximum": 10,
                  "description": "Number of rolls to order"
                }
              },
              "required": ["count"]
            }
          }
        }
      ],
      "pre_actions": [
        {
          "type": "tts_say",
          "text": "Ok, let me help you with your sushi order..."
        }
      ]
    }
  }
}

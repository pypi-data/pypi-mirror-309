import{s as at,e as g,c as h,b as k,f as p,y as wt,o as b,i as X,h as u,z as Xe,A as Ze,n as $e,B as kt,C as Et,G as yt,t as Dt,a as z,d as Ct,g as B,D as xe,j as It,E as Vt,r as L,m as ae,v as je,w as M,F as et}from"../chunks/scheduler.BVk0_e6s.js";import{S as it,i as rt,b as O,c as we,d as ke,m as Ee,t as oe,a as ie,e as Tt,f as ye,g as Ht}from"../chunks/index.B3JOrRZV.js";import{S as Lt,B as Mt,b as Ot,c as St,f as jt}from"../chunks/utils.Cswjn8Jw.js";import{e as tt}from"../chunks/each.D6YF6ztN.js";function ot(e,n,t){const d=e.slice();return d[8]=n[t],d}function nt(e){let n,t=e[8]+"",d,i,v;return{c(){n=g("option"),d=Dt(t),i=z(),this.h()},l(f){n=h(f,"OPTION",{});var l=k(n);d=Ct(l,t),i=B(l),l.forEach(p),this.h()},h(){n.__value=v=e[8],xe(n,n.__value)},m(f,l){X(f,n,l),u(n,d),u(n,i)},p(f,l){l&2&&t!==(t=f[8]+"")&&It(d,t),l&2&&v!==(v=f[8])&&(n.__value=v,xe(n,n.__value))},d(f){f&&p(n)}}}function zt(e){let n,t,d,i,v,f=tt(e[1]),l=[];for(let r=0;r<f.length;r+=1)l[r]=nt(ot(e,f,r));return{c(){n=g("div"),t=g("select");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){n=h(r,"DIV",{class:!0});var s=k(n);t=h(s,"SELECT",{});var a=k(t);for(let w=0;w<l.length;w+=1)l[w].l(a);a.forEach(p),s.forEach(p),this.h()},h(){t.disabled=d=!e[2],e[0]===void 0&&wt(()=>e[4].call(t)),b(n,"class","dropdown")},m(r,s){X(r,n,s),u(n,t);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(t,null);Xe(t,e[0],!0),i||(v=[Ze(t,"change",e[4]),Ze(t,"change",e[5])],i=!0)},p(r,[s]){if(s&2){f=tt(r[1]);let a;for(a=0;a<f.length;a+=1){const w=ot(r,f,a);l[a]?l[a].p(w,s):(l[a]=nt(w),l[a].c(),l[a].m(t,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=f.length}s&4&&d!==(d=!r[2])&&(t.disabled=d),s&3&&Xe(t,r[0])},i:$e,o:$e,d(r){r&&p(n),kt(l,r),i=!1,Et(v)}}}function Bt(e,n,t){let{options:d}=n,{selected_option:i=d[0]}=n,{enabled:v=!0}=n;d.join("_");const f=yt();function l(){f("selection-changed",i)}function r(){i=Vt(this),t(0,i),t(1,d)}const s=()=>l();return e.$$set=a=>{"options"in a&&t(1,d=a.options),"selected_option"in a&&t(0,i=a.selected_option),"enabled"in a&&t(2,v=a.enabled)},[i,d,v,l,r,s]}class Ne extends it{constructor(n){super(),rt(this,n,Bt,zt,at,{options:1,selected_option:0,enabled:2})}}function lt(e){let n,t='<div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){n=g("div"),n.innerHTML=t,this.h()},l(d){n=h(d,"DIV",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-57s7b4"&&(n.innerHTML=t),this.h()},h(){b(n,"class","text-center")},m(d,i){X(d,n,i)},d(d){d&&p(n)}}}function st(e){let n,t,d,i,v;function f(s){e[25](s)}function l(s){e[26](s)}let r={zoom:!0};return e[11]!==void 0&&(r.config=e[11]),e[10]!==void 0&&(r.plot_name=e[10]),t=new Mt({props:r}),L.push(()=>O(t,"config",f)),L.push(()=>O(t,"plot_name",l)),{c(){n=g("div"),we(t.$$.fragment),this.h()},l(s){n=h(s,"DIV",{style:!0});var a=k(n);ke(t.$$.fragment,a),a.forEach(p),this.h()},h(){je(n,"position","relative")},m(s,a){X(s,n,a),Ee(t,n,null),v=!0},p(s,a){const w={};!d&&a&2048&&(d=!0,w.config=s[11],M(()=>d=!1)),!i&&a&1024&&(i=!0,w.plot_name=s[10],M(()=>i=!1)),t.$set(w)},i(s){v||(oe(t.$$.fragment,s),v=!0)},o(s){ie(t.$$.fragment,s),v=!1},d(s){s&&p(n),ye(t)}}}function Pt(e){let n,t='<div class="col"><h2>The Energy Balance</h2></div>',d,i,v,f,l,r,s,a='<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button>',w,D,I,y,Z,re,V,ge,de,he,N,J,De='<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button>',be,W,S,$,A,x,Ce="Year",ve,H,_,K,ce,R,j,ee,ne="Node",P,T,me,ue,c,q,te,fe,We="Carrier",ze,F,Be,Pe,Ie,le,G,Ve,Te;function dt(o){e[14](o)}function ct(o){e[15](o)}function ut(o){e[16](o)}function ft(o){e[17](o)}function _t(o){e[18](o)}let _e={enabled:!e[2]&&!e[3]};e[6]!==void 0&&(_e.carriers=e[6]),e[4]!==void 0&&(_e.nodes=e[4]),e[8]!==void 0&&(_e.years=e[8]),e[0]!==void 0&&(_e.selected_solution=e[0]),e[2]!==void 0&&(_e.loading=e[2]),y=new Lt({props:_e}),L.push(()=>O(y,"carriers",dt)),L.push(()=>O(y,"nodes",ct)),L.push(()=>O(y,"years",ut)),L.push(()=>O(y,"selected_solution",ft)),L.push(()=>O(y,"loading",_t)),y.$on("solution_selected",e[12]);function pt(o){e[19](o)}function gt(o){e[20](o)}let qe={enabled:!e[3]&&!e[2]};e[8]!==void 0&&(qe.options=e[8]),e[9]!==void 0&&(qe.selected_option=e[9]),H=new Ne({props:qe}),L.push(()=>O(H,"options",pt)),L.push(()=>O(H,"selected_option",gt)),H.$on("selection-changed",e[13]);function ht(o){e[21](o)}function bt(o){e[22](o)}let Fe={enabled:!e[3]&&!e[2]};e[4]!==void 0&&(Fe.options=e[4]),e[5]!==void 0&&(Fe.selected_option=e[5]),T=new Ne({props:Fe}),L.push(()=>O(T,"options",ht)),L.push(()=>O(T,"selected_option",bt)),T.$on("selection-changed",e[13]);function vt(o){e[23](o)}function mt(o){e[24](o)}let Ge={enabled:!e[3]&&!e[2]};e[6]!==void 0&&(Ge.options=e[6]),e[7]!==void 0&&(Ge.selected_option=e[7]),F=new Ne({props:Ge}),L.push(()=>O(F,"options",vt)),L.push(()=>O(F,"selected_option",mt)),F.$on("selection-changed",e[13]);let C=e[3]&&lt(),E=!e[3]&&e[1]&&st(e);return{c(){n=g("div"),n.innerHTML=t,d=z(),i=g("div"),v=g("div"),f=g("div"),l=g("div"),r=g("div"),s=g("h2"),s.innerHTML=a,w=z(),D=g("div"),I=g("div"),we(y.$$.fragment),he=z(),N=g("div"),J=g("h2"),J.innerHTML=De,be=z(),W=g("div"),S=g("div"),$=g("div"),A=g("div"),x=g("h3"),x.textContent=Ce,ve=z(),we(H.$$.fragment),ce=z(),R=g("div"),j=g("div"),ee=g("h3"),ee.textContent=ne,P=z(),we(T.$$.fragment),c=z(),q=g("div"),te=g("div"),fe=g("h3"),fe.textContent=We,ze=z(),we(F.$$.fragment),Ie=z(),le=g("div"),G=g("div"),C&&C.c(),Ve=z(),E&&E.c(),this.h()},l(o){n=h(o,"DIV",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1d6fcfp"&&(n.innerHTML=t),d=B(o),i=h(o,"DIV",{class:!0});var m=k(i);v=h(m,"DIV",{class:!0});var Y=k(v);f=h(Y,"DIV",{class:!0,style:!0});var se=k(f);l=h(se,"DIV",{class:!0,id:!0});var Q=k(l);r=h(Q,"DIV",{class:!0});var U=k(r);s=h(U,"H2",{class:!0,"data-svelte-h":!0}),ae(s)!=="svelte-1oln34a"&&(s.innerHTML=a),w=B(U),D=h(U,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Ae=k(D);I=h(Ae,"DIV",{class:!0});var Ke=k(I);ke(y.$$.fragment,Ke),Ke.forEach(p),Ae.forEach(p),U.forEach(p),he=B(Q),N=h(Q,"DIV",{class:!0});var He=k(N);J=h(He,"H2",{class:!0,"data-svelte-h":!0}),ae(J)!=="svelte-1huxmzt"&&(J.innerHTML=De),be=B(He),W=h(He,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Re=k(W);S=h(Re,"DIV",{class:!0});var pe=k(S);$=h(pe,"DIV",{class:!0});var Ye=k($);A=h(Ye,"DIV",{class:!0});var Le=k(A);x=h(Le,"H3",{"data-svelte-h":!0}),ae(x)!=="svelte-r9e7qt"&&(x.textContent=Ce),ve=B(Le),ke(H.$$.fragment,Le),Le.forEach(p),Ye.forEach(p),ce=B(pe),R=h(pe,"DIV",{class:!0});var Je=k(R);j=h(Je,"DIV",{class:!0});var Me=k(j);ee=h(Me,"H3",{"data-svelte-h":!0}),ae(ee)!=="svelte-ocjo5w"&&(ee.textContent=ne),P=B(Me),ke(T.$$.fragment,Me),Me.forEach(p),Je.forEach(p),c=B(pe),q=h(pe,"DIV",{class:!0});var Qe=k(q);te=h(Qe,"DIV",{class:!0});var Oe=k(te);fe=h(Oe,"H3",{"data-svelte-h":!0}),ae(fe)!=="svelte-xc22hm"&&(fe.textContent=We),ze=B(Oe),ke(F.$$.fragment,Oe),Oe.forEach(p),Qe.forEach(p),pe.forEach(p),Re.forEach(p),He.forEach(p),Q.forEach(p),se.forEach(p),Y.forEach(p),m.forEach(p),Ie=B(o),le=h(o,"DIV",{class:!0});var Ue=k(le);G=h(Ue,"DIV",{class:!0,style:!0});var Se=k(G);C&&C.l(Se),Ve=B(Se),E&&E.l(Se),Se.forEach(p),Ue.forEach(p),this.h()},h(){b(n,"class","row"),b(s,"class","accordion-header"),b(I,"class","accordion-body"),b(D,"id","collapseOne"),b(D,"class","accordion-collapse collapse show"),b(D,"data-bs-parent","#accordionExample"),b(r,"class","accordion-item solution-selection"),b(J,"class","accordion-header"),b(A,"class","col-6"),b($,"class","row"),b(j,"class","col-6"),b(R,"class","row"),b(te,"class","col-6"),b(q,"class","row"),b(S,"class","accordion-body"),b(W,"id","collapseTwo"),b(W,"class","accordion-collapse collapse"),b(W,"data-bs-parent","#accordionExample"),b(N,"class","accordion-item"),b(l,"class","accordion"),b(l,"id","accordionExample"),b(f,"class","filters"),je(f,"position","absolute"),je(f,"width","100%"),b(v,"class","col position-relative"),b(i,"class","row"),b(G,"class","col"),je(G,"margin-top","400px"),b(le,"class","row")},m(o,m){X(o,n,m),X(o,d,m),X(o,i,m),u(i,v),u(v,f),u(f,l),u(l,r),u(r,s),u(r,w),u(r,D),u(D,I),Ee(y,I,null),u(l,he),u(l,N),u(N,J),u(N,be),u(N,W),u(W,S),u(S,$),u($,A),u(A,x),u(A,ve),Ee(H,A,null),u(S,ce),u(S,R),u(R,j),u(j,ee),u(j,P),Ee(T,j,null),u(S,c),u(S,q),u(q,te),u(te,fe),u(te,ze),Ee(F,te,null),X(o,Ie,m),X(o,le,m),u(le,G),C&&C.m(G,null),u(G,Ve),E&&E.m(G,null),Te=!0},p(o,[m]){const Y={};m&12&&(Y.enabled=!o[2]&&!o[3]),!Z&&m&64&&(Z=!0,Y.carriers=o[6],M(()=>Z=!1)),!re&&m&16&&(re=!0,Y.nodes=o[4],M(()=>re=!1)),!V&&m&256&&(V=!0,Y.years=o[8],M(()=>V=!1)),!ge&&m&1&&(ge=!0,Y.selected_solution=o[0],M(()=>ge=!1)),!de&&m&4&&(de=!0,Y.loading=o[2],M(()=>de=!1)),y.$set(Y);const se={};m&12&&(se.enabled=!o[3]&&!o[2]),!_&&m&256&&(_=!0,se.options=o[8],M(()=>_=!1)),!K&&m&512&&(K=!0,se.selected_option=o[9],M(()=>K=!1)),H.$set(se);const Q={};m&12&&(Q.enabled=!o[3]&&!o[2]),!me&&m&16&&(me=!0,Q.options=o[4],M(()=>me=!1)),!ue&&m&32&&(ue=!0,Q.selected_option=o[5],M(()=>ue=!1)),T.$set(Q);const U={};m&12&&(U.enabled=!o[3]&&!o[2]),!Be&&m&64&&(Be=!0,U.options=o[6],M(()=>Be=!1)),!Pe&&m&128&&(Pe=!0,U.selected_option=o[7],M(()=>Pe=!1)),F.$set(U),o[3]?C||(C=lt(),C.c(),C.m(G,Ve)):C&&(C.d(1),C=null),!o[3]&&o[1]?E?(E.p(o,m),m&10&&oe(E,1)):(E=st(o),E.c(),oe(E,1),E.m(G,null)):E&&(Ht(),ie(E,1,1,()=>{E=null}),Tt())},i(o){Te||(oe(y.$$.fragment,o),oe(H.$$.fragment,o),oe(T.$$.fragment,o),oe(F.$$.fragment,o),oe(E),Te=!0)},o(o){ie(y.$$.fragment,o),ie(H.$$.fragment,o),ie(T.$$.fragment,o),ie(F.$$.fragment,o),ie(E),Te=!1},d(o){o&&(p(n),p(d),p(i),p(Ie),p(le)),ye(y),ye(H),ye(T),ye(F),C&&C.d(),E&&E.d()}}}function qt(e,n,t){var d=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let i=null,v=!1,f=!1,l=!1,r=[],s=null,a=[],w=null,D=[],I=null,y="",Z="";const re={counter:1,type:"line",data:{datasets:[]},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,title:{display:!0,text:"Power"}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}}}};let V=structuredClone(re);async function ge(){i&&(t(11,V=structuredClone(re)),t(5,s=r[0]),t(7,w=a[0]),t(9,I=D[0]),t(1,v=!1),await de())}async function de(){if(t(3,l=!0),et(),s==null||w==null||I==null||i==null){t(3,l=!1);return}let _=Math.floor((I-i.detail.system.reference_year)/i.detail.system.interval_between_years);console.log("Getting energy balance.");let K=await Ot(i.solution_name,s,w,i.scenario_name,_),ce=await St(i.solution_name,"flow_export",i.scenario_name);ce===null?y="":y=ce.data[0][0];let R=[],j=0;for(const P in K){let T={node:[s]};if(K[P]==null||K[P].data.length==0)continue;if("technology"in K[P].data[0]){let c=[];for(const q of K[P].data)c.push(q.technology);T={technology:c}}let me={},ue=jt(K[P].data,T,me);if(ue.length!=0)for(let c of ue){if(Object.keys(c.data).length==0)continue;switch(P){case"flow_storage_discharge":c.label=c.label+" (discharge)";break;case"flow_transport_in":c.label=c.label+" (transport in)";break;case"flow_import":c.label="Import";break;case"shed_demand":c.label="Shed Demand";break;case"flow_storage_charge":c.label=c.label+" (charge)";break;case"flow_transport_out":c.label=c.label+" (transport out)";break;case"flow_export":c.label="Export";break}let q="line";Object.keys(c.data).length==1&&(q="bar"),P=="demand"?(c.label="Demand",c.type="line",c.stack="ownCustomStack",c.fill=!1,c.borderColor="black",c.backgroundColor="white",c.borderWidth=2,c.stepped=!0,Object.keys(c.data).length==1&&(c.pointRadius=2)):(c.type=q,c.fill="origin",c.borderColor=d[j%d.length],c.backgroundColor=d[j%d.length].replace(")",", 1)"),c.stepped=!0,c.cubicInterpolationMode="monotone"),R.push(c),j++}}t(11,V.data.labels=Object.keys(R[0].data),V),t(11,V.data.datasets=R,V),t(11,V.options.scales.y.title.text="Power ["+y+"]",V),t(3,l=!1),t(1,v=!0);let ee=performance.now();await et();let ne=i.solution_name.split(".");t(10,Z=[ne[(ne==null?void 0:ne.length)-1],i==null?void 0:i.scenario_name,"balance",w,s,I].join("_")),console.log("Building plot took",performance.now()-ee)}function he(_){a=_,t(6,a)}function N(_){r=_,t(4,r)}function J(_){D=_,t(8,D)}function De(_){i=_,t(0,i)}function be(_){f=_,t(2,f)}function W(_){D=_,t(8,D)}function S(_){I=_,t(9,I)}function $(_){r=_,t(4,r)}function A(_){s=_,t(5,s)}function x(_){a=_,t(6,a)}function Ce(_){w=_,t(7,w)}function ve(_){V=_,t(11,V)}function H(_){Z=_,t(10,Z)}return[i,v,f,l,r,s,a,w,D,I,Z,V,ge,de,he,N,J,De,be,W,S,$,A,x,Ce,ve,H]}class At extends it{constructor(n){super(),rt(this,n,qt,Pt,at,{})}}export{At as component};
